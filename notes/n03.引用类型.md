#### `JavaScript`读书笔记

##### 引用类型

引用类型的值（对象）是引用类型的一个实例。在`ECMAScript`中，引用类型是一种数据结构，用于将数据和功能组织在一起。它也常被成为**类**，但是这种称呼并不妥当。尽管`ECMAScript`从技术上讲是一门面向对象的语言，但它不具备传统的面向对象语言所支持的类和接口等基本结构。引用类型有时候也被成为**对象定义**，因为它们描述的是一类对象所具有的属性和方法。

##### 1.x `Object`类型

###### 1.1.x `Object`类型对象的创建方式有两种：
	
* 第一种是使用`new`操作符后跟`Object`构造函数，如下所示：

```javascript
var person = new Object();
person.name = 'Stone';
person.age = 29;
```

* 第二种是使用**对象字面量**表示法。对象字面量是对象定义的一种简写形式，目的在于简化创建包含大量属性的对象的过程。如下所示：

```javascript
var person = {
	name:"Stone",
	age:29
};
```

> 使用字面量表示法更常见。

```javascript
function displayInfo(args) {
    var info = "";
    if (typeof args.name === "string") {
        info += "Name: " + args.name;
    }
    if (typeof args.age === "number") {
        info += "Age: " + args.age;
    }

    console.log("arg===>" + info);
}

displayInfo({name: "张飞", age: 33}); // 参数传入一个对象
displayInfo({name: "王菲"});
displayInfo({name: "北条麻妃", age: 38, "job": "actress"});

```

###### 1.2.x 访问对象属性的两种方式：

> `obj.attr `和 `obj["attr"]`，如下所示：

```javascript
var slave = {"first name": "stone", "last name": "Jack", "age": 22};

console.log(slave['first name'] + " , " + slave.age);
```
> 对于有特殊字符的属性，只能通过`obj.["attr"]`的方式访问了。

##### 2.x `Array`类型

`ECMAScript`数组与其他语言中的数组都是数据的有序列表，但是与其他语言不同的是，`ECMAScript`数据的每一项可以保存任何类型的数据。而且`ECMAScript`数组的大小是可以动态调整的，即可以随着数据的添加自动增长以容纳新增数据。

###### 2.1.x `Array`类型对象创建方式有两种：

* 第一种，通过`new`操作符与`Array`的构造函数来创建：

```
var arr1 = new Array(); // 创建一个空的数组

var arr2 = new Array(3); // 创建一个 length 值为 3 的数组
//  这种创建方式，里面有 3 个元素，每个的值都是 undefined。

var arr3 = new Array("star","shit"); // 创建一个包含两个字符串的数组
```
> 另外，使用这种方式创建数组，`new`操作符也可以省略。

```javascript
var tom = Array("rose","victor");
```

* 第二种，使用数组字面量表示法。如下所示：

```javascript
var colors = ['red','blue','green'];
var names = [];
var values = [1,2,3,]; // todo: 不要这样！这样会创建一个包含3项或4项的数组
var options = [,,,]; // todo: 不要这样！这样会创建一个包含3项或4项的数组
```

###### 2.2.x 读取和设置数组的值
> 要使用方括号并提供相应值的基于`0`的数字索引，如下所示：

```
var colors = ["red", "green", "blue"];
console.log(colors[0]); // 读取值
colors[1] = "yellow";   // 设置值
colors[2] = "black";
```
**数组的`length`属性不是只读的**。因此，通过设置这个属性，可以从数组的末尾移除项或向数组中添加新项。如下所示：

```javascript
var colors = ["red", "blue", "green"];
colors.length = 2; // 原本是3的
console.log(colors[2]); // undefined

colors[colors.length] = "pink"; // 末尾添加一个元素
colors[colors.length] = "gray"; // 末尾再添加一个元素
```

数组的骚操作：

```javascript
var colors = ["red" , "blue" , "green"];

colors[99] = "pink";
console.log(colors.length); // 100
```

通过这种方式也可以跳跃的给数组添加元素，在`[2]-[99]`之间的元素未定义，所以访问它们，返回的都是`undefined`。

###### 2.3.x 判断一个对象是不是数组类型

```
if (value isinstanceof Array){
	// do something
}
```

**`instanceof`操作符的问题在于，它假设单一的全局执行环境**。如果网页中包含多个框架，那实际上就存在两个以上不同的全局执行环境，从而存在两个以上不同版本的`Array`构造函数。如果你从一个框架向另一个框架传入一个数组，那么传入的数组与在第二个框架中原生创建的数组分别具有各自不同的构造函数。

**为了解决这个问题，`ECMAScript5`新增了 `Array.isArray()`方法**。这个方法的
目的是最终确定某个值到底是不是数组，而不管它是在哪个全局执行环境中创建的。
```
if (Array.isArray(value)){
	// do something
} // 这种判断方式更好
```

###### 2.4.x 转换方法

每个对象都包含`toString(),toLocaleString(),valueof()`方法。

```
var colors = ["red", "green" , "blue"];
console.log(colors); // red,green,blue
console.log(colors.toString()); // red,green,blue
console.log(colors.join("|")); // red|green|blue
```
###### 2.5.x 栈方法

栈是一种`LIFO`(last in first out)的数据结构。也就是**最新添加的项最早被移除。**而栈中项的插入（叫做**推入**）和移除（叫做**弹出**），只发生在一个位置--栈的顶部。`ECMAScript`为数组专门提供了`push()`和`pop()`方法，以便实现类似栈的行为。
**`push()`方法可以接收任意数量的参数，把它们逐个添加到数组末尾，并返回修改后数组的长度。而`pop()`方法则从数组的末尾移除最后一项，减少数组的`length`值，然后返回移除的项**。如下所示：

```javascript
var colors = new Array();
var count = colors.push("red","blue");
console.log(count); // 2
count = colors.push("pink");
console.log(count); // 1
var item = colors.pop();
console.log(item); // pink
```

###### 2.6.x 队列方法

栈数据结构的访问规则是`LIFO`(后进先出)，而队列数据结构的访问规则是`FIFO`（first in first out 先进先出）。**队列在列表的末端添加项，从列表的前端移除项**。由于`push()`方法是向数组的末端添加项的方法，因此要模拟队列只需一个从数组前端取出项的方法。实现这一操作的数组方式就是`shift()`，它能够移除数组的第一个项并返回该项，同时将数组的长度-1.**结合使用 `shift()`和`push()`方法，就可以像使用队列一样使用数组**。

* 反向队列

`ECMAScript`还为数组提供了一个`unshift()`方法。`unshift()`方法与`shift()`的用途相反：它能再数组的前端添加任意个项并返回新数组的长度。因此，**同时使用 `unshift()`和`pop()`方法，可以从相反飞方法来模拟队列，即在数组的前端添加项，从数组的末端移除项**。

###### 2.7.x 重排序方法

数组中已经存在两个可以直接用来重排序的方法：`reverse()`和`sort()`。

> `reverse()`方法用于反转数组。
> 默认情况下，`sort()`方法按升序排列数组项--即，最小值在最前面，最大值在最后面。*为了实现排序，`sort()`方法会调用每个数组项的`toString()`转型方法，然后比较得到的字符串，以确定如何排序。即使数组的每一项都是数值，`sort()方法比较的也是字符串`*。

```javascript
var values = [0 ,1 , 5, 10 ,15];
values.sort();

console.log(values); // 0,1,10,15,5
```

***sort()方法可以接受一个比较函数作为参数，以便我们指定哪个值位于哪个值的前面***

> 比较函数接受两个参数，如果第一个参数应该位于第二个之前则返回一个负数，如果两个参数相等则返回0，如果第一个参数应该位于第二个参数之后则返回一个正数。如下所示：

```

var stu1 = {
    name: "python", age: 80, grade: 99,
    toString: function () {
        return this.name + " , " + this.age + " , " + this.grade;
    }
};
var stu2 = {
    name: "javascript", age: 30, grade: 88, toString: function () {
        return this.name + " , " + this.age + " , " + this.grade;
    }
};
var stu3 = {
    name: "php", age: 18, grade: 59, toString: function () {
        return this.name + " , " + this.age + " , " + this.grade;
    }
};
var stu4 = {
    name: "vb", age: 50, grade: 70, toString: function () {
        return this.name + " , " + this.age + " , " + this.grade;
    }
};
var stu5 = {
    name: "shell", age: 60, grade: 70, toString: function () {
        return this.name + " , " + this.age + " , " + this.grade;
    }
};
var stu6 = {
    name: "java", age: 40, grade: 99, toString: function () {
        return this.name + " , " + this.age + " , " + this.grade;
    }
};

var langArr = [stu1, stu2, stu3, stu4, stu5, stu6];

console.log("排序前：" + langArr);
console.log("-------------------");


function compare(a, b) {
    if (a.grade > b.grade) {
        return -5;
    } else if (a.grade === b.grade) {
        return 0;
    } else {
        return 5;
    }
} // todo:简单排序，仅仅通过分数进行排序

function cmp(a, b) {

    if (a.grade > b.grade) {
        return -5;
    } else if (a.grade === b.grade) {
        // return 0;
        if (a.age < b.age) {
            return -4;
        } else if (a.age === b.age) {
            return a.name.localeCompare(b.name);
        } else {
            return 4;
        }
    } else {
        return 5;
    }
} // todo:复杂排序，先比较分数，然后是年龄，最后是名字字符串

// langArr.sort(compare);
langArr.sort(cmp);

console.log("排序后：" + langArr);

```

###### 2.8.x 操作方法

`ECMAScript`为操作已经包含在数组中的项提供了很多方法。
	
* 其中，`concat()`方法可以基于当前数组中的所有项创建一个新数组。具体来说，这个方法会先创建当前数组的一个副本，然后将接收到的参数添加到这个副本的末尾，最后返回新构建的数组，在没有给`concat()`方法传递参数的情况下，它只是复制当前数组并返回副本。如果传递给`concat()`方法的是一个或多个数组，则该方法会将这些数组中的每一项都添加到结果数组中。如果传递的值不是数组，这些值就会简单地被添加到结果数组的末尾。如下所示：

```javascript
var colors = ["red" , "green" , "blue" ];

var colors2 = colors.concat("pink" , ["white" , "black"]);

console.log(colors2.toString()); // red,green,blue,pink,white,black
```

* 然后是`slice()`方法。它能够基于当前数组中的一个或多个项创建一个新的**数组**。`slice()`方法可以接受一个或两个参数，即要返回项的起始和结束位置。但是在只有一个参数的情况下，`slice()`方法返回从该参数指定位置开始到当前数组末尾的所有项。如果有两个参数，该方法返回起始和结束位置之间的项--但是不包括结束位置的项。注意，`slice()`方法不会影响原来的数组。如下所示：

```javascript
var colors = ["red" , "green" , "blue" ];
var another = colors.slice(0,1);
var demo = colors.slice(1);

console.log(another.toString()); // red -->实际是 ['red'];
console.log(demo.toString()); // green,blue
```
> 如果`slice()`方法的参数中有一个负数，则用数组长度加上该数来确定相应的位置。例如，在一个包含`5`项的数组上调用`slice(-2,-1)`与调用`slice(5-2,5-1)`得到的结果相同。如果结束位置小于起始位置，则返回空数组。

* **强大的`splice()`方法**

***注意：这个方法和之前的`concat() , slice()`不同的是，这个方法是原地修改，修改当前数组，而不是产生一个副本！！！！***

> 该方法的返回值是由被删除的项组成的数组。

它有很多种用法。`splice()`的主要用途是向数组的中部插入项，但是使用这种方法的方式则有`3`种。

> 删除：可以删除任意数量的项，只需指定`2`个参数：要删除的第一项的位置和要删除的项数。例如，`splice(0,2)`会删除数组中的前两项。

> 插入：起始位置、0（要删除的项数）和要插入的项。如果要插入多个项，可以再传入第四个，第五个以至任意多个项目。例如，`splice(2,0,"red","green")`会从当前数组的位置2开始插入字符串`"red"`和`"green"`.

> 替换：可以像指定位置插入任意数量的项，且同时可以删除任意数量的项，只需指定3个参数：起始位置、要删除的项数和要插入的任意数量的项。插入的项数不必与删除的项数相等。例如：`splice(2,1,"red","green")`会删除当前数组位置`2`的项，然后再从位置2开始插入字符串`"red"`和`"green"`。

```
var names=["python","php","perl","pascal"];
var another = names.splice(1,2,"java");
console.log(names+" ### "+another +" >>> "+(another instanceof Array));
```
> 输出如下：
```
python,java,pascal ### php,perl >>> true
```

从输出可以看到，将原数组的元素从`index=1`开始，删除了`2`个元素，并且，在`index=1`的位置插入了新的元素`"java"`。

-<>- 从`index=1`开始删除`2`个元素，然后在`index=1`的位置，插入`"java","javascript","golang","shell"`这几个元素。

```
var names=["python","php","perl","pascal"];
var another = names.splice(1,2,"java","javascript","golang","shell");
console.log(names+"");
```
> 输出如下：
```
python,java,javascript,golang,shell,pascal
```
