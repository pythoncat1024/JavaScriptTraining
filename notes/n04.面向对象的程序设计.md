[TOC]
## `JavaScript`è¯»ä¹¦ç¬”è®°

> å¤‡æ³¨ï¼šä¸ºäº†é˜²æ­¢æ ‡ç­¾é”™ä¹±ï¼Œç°åœ¨è§„å®šï¼Œæ ‡é¢˜ç”¨ `##` ï¼Œä¸€çº§æ ‡é¢˜æ˜¯`###` ï¼Œ äºŒçº§æ˜¯`####` ï¼Œ ä¸‰çº§æ˜¯ `#####`ã€‚

### é¢å‘å¯¹è±¡çš„ç¨‹åºè®¾è®¡

å†…å®¹ï¼ˆ3ç‚¹ï¼‰ï¼š
> ç†è§£å¯¹è±¡å±æ€§
> 
> ç†è§£å¹¶åˆ›å»ºå¯¹è±¡
> 
> ç†è§£ç»§æ‰¿

é¢å‘å¯¹è±¡ï¼ˆ`Object-Oriented`,`OO`ï¼‰çš„è¯­è¨€æœ‰ä¸€ä¸ªæ ‡å¿—ï¼Œé‚£å°±æ˜¯ä»–ä»¬éƒ½æœ‰ç±»çš„æ¦‚å¿µï¼Œè€Œé€šè¿‡ç±»å¯ä»¥åˆ›å»ºä»»æ„å¤šä¸ªå…·æœ‰ç›¸åŒå±æ€§å’Œæ–¹æ³•çš„å¯¹è±¡ã€‚å‰é¢æè¿‡ï¼Œ`ECMAScript`ä¸­æ²¡æœ‰ç±»çš„æ¦‚å¿µï¼Œå› æ­¤å®ƒçš„å¯¹è±¡ä¹Ÿä¸åŸºäºç±»çš„è¯­è¨€çš„å¯¹è±¡æœ‰æ‰€ä¸åŒã€‚
`ECMA-262`æŠŠå¯¹è±¡å®šä¹‰ä¸ºï¼šâ€œ**æ— åºå±æ€§çš„é›†åˆï¼Œå…¶å±æ€§å¯ä»¥åŒ…å«åŸºæœ¬å€¼ã€å¯¹è±¡æˆ–è€…å‡½æ•°**ã€‚â€ä¸¥æ ¼æ¥è®²ï¼Œè¿™å°±ç›¸å½“äºè¯´å¯¹è±¡æ˜¯ä¸€ç»„æ²¡æœ‰ç‰¹ç‚¹é¡ºåºçš„å€¼ã€‚å¯¹è±¡çš„æ¯ä¸ªå±æ€§æˆ–è€…æ–¹æ³•éƒ½æœ‰ä¸€ä¸ªåå­—ï¼Œè€Œæ¯ä¸ªåå­—éƒ½æ˜ å°„åˆ°ä¸€ä¸ªå€¼ã€‚æ­£å› ä¸ºè¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ`ECMAScript`çš„å¯¹è±¡æƒ³è±¡æˆæ•£åˆ—è¡¨ï¼šæ— éå°±æ˜¯ä¸€ç»„åå€¼å¯¹ï¼Œå…¶ä¸­å€¼å¯ä»¥æ˜¯æ•°æ®æˆ–å‡½æ•°ã€‚

æ¯ä¸ªå¯¹è±¡éƒ½æ˜¯åŸºäºå¼•ç”¨ç±»å‹åˆ›å»ºçš„ï¼Œè¿™ä¸ªå¼•ç”¨ç±»å‹å¯ä»¥æ˜¯åŸç”Ÿç±»å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯è‡ªå®šä¹‰çš„ç±»å‹ã€‚

#### 1 ç†è§£å¯¹è±¡

åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰å¯¹è±¡çš„ç®€å•æ–¹å¼ï¼š

```javascript
var person = new Object();
person.name = 'Luna';
person.age = 29;
person.job = "software engineer";

person.sayName = function(){
	console.log(this.name);
	// è¿™é‡Œçš„ this å°±æ˜¯ person å¯¹è±¡
}
```
ä½¿ç”¨å­—é¢é‡è¡¨ç¤ºæ³•ï¼š

```javascript
var person = {
	name : 'Luna',
	age : 29,
	job : 'software engineer',
	sayName : function() {
		console.log(this.name);
	}
};
```

ä¸¤ç§æ–¹å¼åˆ›å»ºçš„`person`å¯¹è±¡æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æœ‰ç›¸åŒçš„å±æ€§å’Œæ–¹æ³•ã€‚è¿™äº›å±æ€§åœ¨åˆ›å»ºæ—¶éƒ½å¸¦æœ‰ä¸€äº›ç‰¹å¾å€¼(`characteristic`)ï¼Œ`Javascript`é€šè¿‡è¿™äº›ç‰¹å¾å€¼æ¥å®šä¹‰å®ƒä»¬çš„è¡Œä¸ºã€‚

##### 1.1 å±æ€§ç±»å‹

`ECMAScript`ä¸­æœ‰ä¸¤ç§å±æ€§ï¼šæ•°æ®å±æ€§å’Œè®¿é—®å™¨å±æ€§ã€‚

###### 01 æ•°æ®å±æ€§

æ•°æ®å±æ€§åŒ…å«ä¸€ä¸ªæ•°æ®å€¼çš„ä½ç½®ã€‚åœ¨è¿™ä¸ªä½ç½®å¯ä»¥è¯»å–å’Œå†™å…¥å€¼ã€‚æ•°æ®å±æ€§æœ‰4ä¸ªæè¿°å…¶è¡Œä¸ºçš„ç‰¹æ€§ã€‚

* `[[Configrable]]`: è¡¨ç¤ºèƒ½å¦é€šè¿‡`delete`åˆ é™¤å±æ€§ä»è€Œé‡å†™å®šä¹‰å±æ€§ï¼Œèƒ½å¦ä¿®æ”¹å±æ€§çš„ç‰¹æ€§ï¼Œæˆ–è€…èƒ½å¦æŠŠå±æ€§ä¿®æ”¹ä¸ºè®¿é—®å™¨å±æ€§ã€‚åƒå‰é¢ä¾‹å­ä¸­é‚£æ ·ç›´æ¥åœ¨å¯¹è±¡ä¸Šå®šä¹‰çš„å±æ€§ï¼Œå®ƒä»¬çš„è¿™ä¸ªç‰¹æ€§é»˜è®¤å€¼ä¸º`true`ã€‚
* `[[Enumerable]]`: è¡¨ç¤ºèƒ½å¦é€šè¿‡`for-in`å¾ªç¯è¿”å›å±æ€§ã€‚åƒå‰é¢ä¾‹å­ä¸­é‚£æ ·ç›´æ¥åœ¨å¯¹è±¡ä¸Šå®šä¹‰çš„å±æ€§ï¼Œå®ƒä»¬çš„è¿™ä¸ªç‰¹æ€§é»˜è®¤å€¼ä¸º`true`ã€‚
* `[[Writable]]`: è¡¨ç¤ºèƒ½å¦ä¿®æ”¹å±æ€§çš„å€¼ã€‚åƒå‰é¢ä¾‹å­ä¸­é‚£æ ·ç›´æ¥åœ¨å¯¹è±¡ä¸Šå®šä¹‰çš„å±æ€§ï¼Œå®ƒä»¬çš„è¿™ä¸ªç‰¹æ€§é»˜è®¤å€¼ä¸º`true`ã€‚
* `[[Value]]`: åŒ…å«è¿™ä¸ªå±æ€§çš„æ•°æ®å€¼ã€‚è¯»å–å±æ€§å€¼çš„æ—¶å€™ï¼Œä»è¿™ä¸ªä½ç½®è¯»ï¼›å†™å…¥å±æ€§å€¼çš„æ—¶å€™ï¼ŒæŠŠæ–°å€¼ä¿å­˜åœ¨è¿™ä¸ªä½ç½®ã€‚è¿™ä¸ªç‰¹æ€§çš„é»˜è®¤å€¼ä¸º`undefined`ã€‚

è¦ä¿®æ”¹å±æ€§é»˜è®¤çš„ç‰¹æ€§ï¼Œå¿…é¡»ä½¿ç”¨`ECMAScript5`çš„`Object.defineProperty()`æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼šå±æ€§æ‰€åœ¨çš„å¯¹è±¡ï¼Œå±æ€§çš„åå­—å’Œä¸€ä¸ªæè¿°ç¬¦å¯¹è±¡ã€‚å…¶ä¸­æè¿°ç¬¦ï¼ˆ`descriptor`ï¼‰å¯¹è±¡çš„å±æ€§å¿…é¡»æ˜¯ï¼š`configurable`ã€`enumerable`ã€`writable`ã€`value`ã€‚è®¾ç½®å…¶ä¸­ä¸€ä¸ªæˆ–è€…å¤šä¸ªå€¼ï¼Œå¯ä»¥ä¿®æ”¹å¯¹è±¡çš„ç‰¹å¾å€¼ã€‚å¦‚ä¸‹:

> ä¿®æ”¹å¯¹è±¡çš„ `value`å’Œ`writeable`å±æ€§ï¼š

```javascript
var person = {
	name : 'Luna'
};

var desc = {
	value : 18,
	writeable : false
};

Object.defineProperty(person,"age",desc);
person.age = 30;

console.log(person.age);
```
> `Object.defineProperty()`æ–¹æ³•ï¼Œåœ¨å¤šæ•°æƒ…å†µä¸‹éƒ½ä¸éœ€è¦ä½¿ç”¨ã€‚

###### 02 è®¿é—®å™¨å±æ€§

è®¿é—®å™¨å±æ€§ä¸åŒ…å«æ•°æ®å€¼ï¼›å®ƒä»¬åŒ…å«ä¸€å¯¹å„¿`getter`å’Œ`setter`å‡½æ•°ã€‚ï¼ˆä¸è¿‡ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°éƒ½ä¸æ˜¯å¿…é¡»çš„ï¼‰ã€‚åœ¨è¯»å–è®¿é—®å™¨å±æ€§æ—¶ï¼Œä¼šè°ƒç”¨`getter`å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°è´Ÿè´£è¿”å›æœ‰æ•ˆçš„å€¼ï¼›åœ¨å†™å…¥è®¿é—®å™¨å±æ€§æ—¶ï¼Œä¼šè°ƒç”¨`setter`å‡½æ•°å¹¶ä¼ å…¥æ–°å€¼ï¼Œè¿™ä¸ªå‡½æ•°è´Ÿè´£å†³å®šå¦‚ä½•å¤„ç†æ•°æ®ã€‚è®¿é—®å™¨å±æ€§æœ‰å¦‚ä¸‹4ä¸ªç‰¹æ€§ã€‚

* `[[Configurable]]`: è¡¨ç¤ºèƒ½å¦é€šè¿‡`delete`åˆ é™¤å±æ€§ä»è€Œé‡å†™å®šä¹‰å±æ€§ï¼Œè¿™ä¸ªç‰¹æ€§çš„é»˜è®¤å€¼ä¸º`true`ã€‚
* `[[Enumrable]]`: è¡¨ç¤ºèƒ½å¦é€šè¿‡`for-in`å¾ªç¯è¿”å›å±æ€§ã€‚å¯¹äºç›´æ¥åœ¨å¯¹è±¡ä¸Šå®šä¹‰çš„å±æ€§ï¼Œè¿™ä¸ªç‰¹æ€§çš„é»˜è®¤å€¼ä¸º`true`ã€‚
* `[[Get]]`: åœ¨è¯»å–å±æ€§æ—¶è°ƒç”¨çš„å‡½æ•°ï¼Œé»˜è®¤å€¼ä¸º`undefined`ã€‚
* `[[Set]]`: åœ¨å†™å…¥å±æ€§æ—¶è°ƒç”¨çš„å‡½æ•°ã€‚é»˜è®¤å€¼ä¸º`undefined`ã€‚

è®¿é—®å™¨å±æ€§ä¸èƒ½ç›´æ¥å®šä¹‰ï¼Œå¿…é¡»ä½¿ç”¨`Object.defineProperty()`æ¥å®šä¹‰ã€‚å¦‚ä¸‹ç¤ºä¾‹ï¼š

```javascript
var book = {
    _year: 2004,
    edition: 1
};
book.price = 1024.4;

// å®šä¹‰è®¿é—®å™¨å±æ€§ year
Object.defineProperty(book, "year", {
    set: function (val) {
        this._year = val;
        if (val > 2004) {
            this.edition += val - 2004;
        }
    },
    get: function () {
        return this._year;
    }
    // ,enumerable: true  // åŠ ä¸Šè¿™å¥å°±å¯ä»¥è¾“å‡º year å±æ€§
});

book.year = 2018; // å®šä¹‰å®Œæˆå°±å¯ä»¥è°ƒç”¨ è¯¥å±æ€§äº†
console.log(book.year + " , " + book.edition);

book._year = 2028;
console.log(book._year + " , " + book.edition);


for (var prop in book) {
    console.log("prop: " + prop); 
    // å¹¶ä¸ä¼šè¾“å‡º year è¿™ä¸ªå±æ€§
}
```

ä»¥ä¸Šä»£ç åˆ›å»ºäº†ä¸€ä¸ª`book`å¯¹è±¡ï¼Œå¹¶ç»™å®ƒå®šä¹‰äº†ä¸¤ä¸ªé»˜è®¤å±æ€§ï¼š`_year`,`edition`ã€‚`_year`å‰é¢çš„ä¸‹åˆ’çº¿æ˜¯ä¸€ç§å¸¸ç”¨çš„è®°å·ï¼Œç”¨æ¥è¡¨ç¤ºåªèƒ½é€šè¿‡å¯¹è±¡æ–¹æ³•è®¿é—®çš„å±æ€§ã€‚è€Œè®¿é—®å™¨å±æ€§`year`åˆ™åŒ…å«ä¸€ä¸ª`getter`å‡½æ•°å’Œä¸€ä¸ª`setter`å‡½æ•°ã€‚`getter`å‡½æ•°è¿”å›`_year`çš„å€¼ï¼Œ`setter`å‡½æ•°é€šè¿‡è®¡ç®—æ¥ç¡®å®šæ­£ç¡®çš„ç‰ˆæœ¬ã€‚å› æ­¤æŠŠ`year`å±æ€§ä¿®æ”¹ä¸º`2018`ä¼šå¯¼è‡´`_year`å˜æˆ`2018`ï¼Œè€Œ`edtion`å˜æˆ`15`ã€‚è¿™æ˜¯ä½¿ç”¨è®¿é—®å™¨å±æ€§çš„å¸¸è§æ–¹å¼ï¼Œå³è®¾ç½®ä¸€ä¸ªå±æ€§çš„å€¼ä¼šå¯¼è‡´å…¶ä»–å±æ€§å‘ç”Ÿå˜åŒ–ã€‚

> ä¸ä¸€å®šè¦åŒæ—¶æŒ‡å®š`getter`å’Œ`setter`ã€‚ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œéœ€è¦åŒæ—¶æŒ‡å®šã€‚

##### 1.2 å®šä¹‰å¤šä¸ªå±æ€§

ç”±äºä¸ºå¯¹è±¡å®šä¹‰å¤šä¸ªå±æ€§çš„å¯èƒ½æ€§å¾ˆå¤§ï¼Œ`ECMAScript5`åˆå®šä¹‰äº†ä¸€ä¸ª`Object.defineProperties()`æ–¹æ³•ã€‚åˆ©ç”¨è¿™ä¸ªæ–¹æ³•å¯ä»¥é€šè¿‡æè¿°ç¬¦ä¸€æ¬¡æ€§å®šä¹‰å¤šä¸ªå±æ€§ã€‚è¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå¯¹è±¡å‚æ•°ï¼šç¬¬ä¸€ä¸ªå¯¹è±¡æ˜¯è¦æ·»åŠ å’Œä¿®æ”¹å…¶å±æ€§çš„å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå¯¹è±¡çš„å±æ€§ä¸ç¬¬ä¸€ä¸ªå¯¹è±¡ä¸­è¦æ·»åŠ æˆ–ä¿®æ”¹çš„å±æ€§ä¸€ä¸€å¯¹åº”ã€‚å¦‚ä¸‹ï¼š

```javascript
/**
 * Created by cat on 2018/4/21.
 */

var book = {};

var props = {
    _year: {
        value: 2004
        , enumerable: true
    },
    edition: {
        value: 1
        // , enumerable: true
    },
    year: {
        set: function (val) {
            this._year = val;
            if (val > 2004) {
                this.edition += val - 2004;
            }
        },
        get: function () {
            return this._year
        }
        , enumerable: true
    }
};

console.log(props + " ### " + typeof props + " , " + Boolean(props));
Object.defineProperties(book, props);


for (var prop in book) {
    console.log(prop, book[prop]);
}
```

> ä¸Šè¿°ä»£ç ç»™`book`å¯¹è±¡æ·»åŠ äº†`_year`,`year`,`edition`ï¼Œè¿™ä¸‰ä¸ªå±æ€§ã€‚å¹¶è®¾ç½®`_year`ä¸`year`å±æ€§æ˜¯å¯æšä¸¾çš„ï¼ˆå¯ä»¥é€šè¿‡å¯¹å¯¹è±¡æ‰§è¡Œ`for-in`è¯­å¥è¿”å›å¯¹åº”çš„å±æ€§ï¼‰ã€‚

--

> TIPS: *ç»™å±æ€§å‰é¢åŠ `_`æˆä¸º`_year`åªæ˜¯ä¸å¸Œæœ›å¤–éƒ¨ç›´æ¥è®¿é—®ï¼Œå¹¶ä¸æ˜¯è¯´å¤–éƒ¨ä¸èƒ½ç›´æ¥è®¿é—®!*

##### 1.3 è¯»å–å±æ€§çš„ç‰¹æ€§

ä½¿ç”¨`ECMAScript5`çš„`Object.getOwnPropertyDescriptor()`æ–¹æ³•ï¼Œå¯ä»¥å–å¾—ç»™å®šå±æ€§çš„æè¿°ç¬¦ã€‚è¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šå±æ€§æ‰€åœ¨çš„å¯¹è±¡å’Œè¦å»è¯»å…¶æè¿°ç¬¦çš„å±æ€§çš„åç§°ã€‚è¿”å›å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚*å¦‚æœæ˜¯æ•°æ®å±æ€§ï¼Œè¿™ä¸ªå¯¹è±¡çš„å±æ€§æœ‰`configurable`,`enumerable`,`writeable`,`value`*ï¼›*å¦‚æœæ˜¯è®¿é—®å™¨å±æ€§ï¼Œè¿™ä¸ªå¯¹è±¡çš„å±æ€§æœ‰`configurable`,`enumerable`,`get`,`set`*ã€‚

```javascript

var descriptor = Object.getOwnPropertyDescriptor(book,"_year");
// éå†æè¿°ç¬¦å¯¹è±¡ï¼Œè¯»å–å…¶å±æ€§
for(prop in descriptor){
    console.log(prop, descriptor[prop]);
}
```
> æ•°æ®å±æ€§è¿”å›ï¼ˆè¿™é‡Œæ˜¯`_year`å±æ€§ï¼‰ï¼š

```
value 2004
writable false
enumerable true
configurable false
```

> è®¿é—®å™¨å±æ€§çš„æè¿°ç¬¦ä¸­æœ‰ï¼ˆè¿™é‡Œæ˜¯`year`å±æ€§ï¼‰ï¼š

```
get function () {
            return this._year
        }
set function (val) {
            this._year = val;
            if (val > 2004) {
                this.edition += val - 2004;
            }
        }
enumerable true
configurable false
```

#### 2 åˆ›å»ºå¯¹è±¡

è™½ç„¶`Object`æ„é€ å‡½æ•°æˆ–è€…å¯¹è±¡å­—é¢é‡éƒ½å¯ä»¥åˆ›å»ºå•ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯è¿™ä¸ªæ–¹å¼æœ‰ä¸ªæ˜æ˜¾çš„ç¼ºç‚¹ï¼šä½¿ç”¨åŒä¸€ä¸ªæ¥å£åˆ›å»ºå¾ˆå¤šå¯¹è±¡ï¼Œä¼šäº§ç”Ÿå¤§é‡çš„é‡å¤ä»£ç ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œäººä»¬å¼€å§‹ä½¿ç”¨å·¥å‚æ¨¡å¼çš„çš„ä¸€ç§å˜ä½“ã€‚

##### 2.1 å·¥å‚æ¨¡å¼

```javascript
function createPerson(name,age,job){
	var person = {};
	person.name = name;
	person.age = age;
	person.job = job;
	person.sayName = function(){
		console.log(person.name);
	}
	
	return person;
}

console.log(a.valueOf());
console.log(b.valueOf());

console.log(a instanceof Object);
```
> ä½†æ˜¯è¿™ä¸ªæ–¹æ³•ä¹Ÿè¦ä¸€ä¸ªç¼ºç‚¹ï¼Œå°±æ˜¯ä¸çŸ¥é“åˆ›å»ºçš„è¿™ä¸ªå¯¹è±¡çš„å…·ä½“ç±»å‹ï¼ŒåªçŸ¥é“æ˜¯ä¸€ä¸ª`Obejct`ç±»å‹ã€‚ï¼ˆæ²¡æœ‰è§£å†³å¯¹è±¡è¯†åˆ«é—®é¢˜ï¼‰

##### 2.2 æ„é€ å‡½æ•°æ¨¡å¼

**`ECMAScript`ä¸­æ„é€ å‡½æ•°å¯ä»¥ç”¨æ¥åˆ›å»ºç‰¹å®šç±»å‹çš„å¯¹è±¡**ã€‚åƒ`Object`å’Œ`Array`è¿™æ ·çš„åŸç”Ÿæ„é€ å‡½æ•°ï¼Œåœ¨è¿è¡Œæ—¶ä¼šè‡ªåŠ¨å‡ºç°åœ¨æ‰§è¡Œç¯å¢ƒä¸­ã€‚æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥åˆ›å»ºè‡ªå®šä¹‰çš„æ„é€ å‡½æ•°ï¼Œä»è€Œå®šä¹‰è‡ªå®šä¹‰å¯¹è±¡ç±»å‹çš„å±æ€§å’Œæ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨æ„é€ å‡½æ•°æ¨¡å¼å°†å‰é¢çš„ä¾‹å­é‡å†™ã€‚å¦‚ä¸‹ï¼š

```javascript
function Person(name, age, job) {
    this.name = name;
    this.age = age;
    this.job = job;
    this.sayName = function () {
        return this.name;
    };
}

var p1 = new Person("Ann" , 23 , "actress");
var p2 = new Person("Rose" , 23 , "writer");
```

è¿™ç§æ–¹å¼å’Œä¸Šä¸€ç§(`createPerson()`)ï¼Œæœ‰ä¸€äº›ä¸åŒä¹‹å¤„ï¼š

* æ²¡æœ‰æ˜¾å¼åœ°åˆ›å»ºå¯¹è±¡ï¼›
* ç›´æ¥å°†å±æ€§å€¼èµ‹ç»™äº†`this`å¯¹è±¡ï¼› **æé—®ï¼šè¿™é‡Œçš„thisæ˜¯ä»€ä¹ˆï¼Œæ˜¯window å—ï¼Ÿ**
* æ²¡æœ‰returnè¯­å¥ã€‚

æ­¤å¤–ï¼Œå‡½æ•°å`Person`é¦–å­—æ¯å¤§å†™ï¼Œè¿™æ˜¯æ„é€ å‡½æ•°çš„æƒ¯ä¾‹ã€‚ï¼ˆ*éå¿…é¡»ï¼Œæ˜¯æ¨èæ–¹å¼*ï¼‰ä¸»è¦ç›®çš„æ˜¯åŒºåˆ†æ„é€ å‡½æ•°å’Œ`ECMAScript`ä¸­çš„å…¶ä»–å‡½æ•°ï¼›å› ä¸ºæ„é€ å‡½æ•°æœ¬èº«ä¹Ÿæ˜¯å‡½æ•°ï¼Œåªä¸è¿‡å¯ä»¥ç”¨æ¥åˆ›å»ºå¯¹è±¡è€Œå·²ã€‚

**è¦åˆ›å»º`Person`çš„æ–°å®ä¾‹ï¼Œå¿…é¡»ä½¿ç”¨`new`æ“ä½œç¬¦**ã€‚ä»¥è¿™ç§æ–¹å¼è°ƒç”¨æ„é€ å‡½æ•°ï¼Œå®é™…ä¸Šä¼šç»å†ä»¥ä¸‹`4`ä¸ªæ­¥éª¤ï¼š

1. **åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡**ï¼›
2. **å°†æ„é€ å‡½æ•°çš„ä½œç”¨åŸŸèµ‹ç»™æ–°å¯¹è±¡ï¼ˆå› æ­¤ `this` å°±æŒ‡å‘äº†è¿™ä¸ªæ–°å¯¹è±¡ï¼‰**ï¼›
3. **æ‰§è¡Œæ„é€ å‡½æ•°ä¸­çš„ä»£ç ï¼ˆä¸ºè¿™ä¸ªæ–°å¯¹è±¡æ·»åŠ å±æ€§ï¼‰**ï¼›
4. **è¿”å›æ–°å¯¹è±¡**ã€‚


*è´¨ç–‘ï¼šæ„é€ å‡½æ•°ä¸æ™®é€šå‡½æ•°æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œè°ƒç”¨æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡å¿…é¡»ä½¿ç”¨`new`æ“ä½œç¬¦å—ï¼Ÿèƒ½ä¸èƒ½çœç•¥`new`ï¼Ÿ*

--- é€šè¿‡æ¯”è¾ƒ`this`å¯¹è±¡æ¥æŸ¥çœ‹åŒºåˆ«ã€‚

> 1 ä½¿ç”¨`new`è°ƒç”¨æ„é€ å‡½æ•°çš„ä»£ç ï¼š

```javascript
console.log("<>>>before thisæ˜¯ Window ç±»å‹å—ï¼Ÿ " + (this instanceof Window));
function Person(name, age, job) {
    console.log("inner thisæ˜¯ Window ç±»å‹å—ï¼Ÿ " + (this instanceof Window));
    console.log("inner thisæ˜¯ Person ç±»å‹å—ï¼Ÿ " + (this instanceof Person));
    this.name = name;
    this.age = age;
    this.job = job;
    this.sayName = function () {
        return this.name;
    };
}
var p1 = new Person("Ann", 23, "actress"); 
// todo: ä½¿ç”¨äº† new æ“ä½œç¬¦
console.log("outer thisæ˜¯ Window ç±»å‹å—ï¼Ÿ " + (this instanceof Window));
console.log("outer thisæ˜¯ Person ç±»å‹å—ï¼Ÿ " + (this instanceof Person));

// åœ¨æµè§ˆå™¨è¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹

/**
 <pre>
 // todo: åœ¨æµè§ˆå™¨è¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ :
 <>>>before thisæ˜¯ Window ç±»å‹å—ï¼Ÿ true
 inner thisæ˜¯ Window ç±»å‹å—ï¼Ÿ false
 inner thisæ˜¯ Person ç±»å‹å—ï¼Ÿ true
 outer thisæ˜¯ Window ç±»å‹å—ï¼Ÿ true
 outer thisæ˜¯ Person ç±»å‹å—ï¼Ÿ false
 </pre>
 */

```
> 2 ä¸ä½¿ç”¨`new`ï¼Œç›´æ¥è°ƒç”¨æ„é€ å‡½æ•°çš„ä»£ç ï¼š

```javascript
console.log("<>>>before thisæ˜¯ Window ç±»å‹å—ï¼Ÿ " + (this instanceof Window));
function Person(name, age, job) {
    console.log("inner thisæ˜¯ Window ç±»å‹å—ï¼Ÿ " + (this instanceof Window));
    console.log("inner thisæ˜¯ Person ç±»å‹å—ï¼Ÿ " + (this instanceof Person));
    this.name = name;
    this.age = age;
    this.job = job;
    this.sayName = function () {
        return this.name;
    };
}
var p1 = Person("Ann", 23, "actress"); // æ³¨æ„ï¼šè¿™é‡Œæ²¡æœ‰ new
console.log("outer thisæ˜¯ Window ç±»å‹å—ï¼Ÿ " + (this instanceof Window));
console.log("outer thisæ˜¯ Person ç±»å‹å—ï¼Ÿ " + (this instanceof Person));

/*
 <pre>
 // todo: åœ¨æµè§ˆå™¨è¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ :
 <>>>before thisæ˜¯ Window ç±»å‹å—ï¼Ÿ true
 inner thisæ˜¯ Window ç±»å‹å—ï¼Ÿ true
 inner thisæ˜¯ Person ç±»å‹å—ï¼Ÿ false
 outer thisæ˜¯ Window ç±»å‹å—ï¼Ÿ true
 outer thisæ˜¯ Person ç±»å‹å—ï¼Ÿ false
 </pre>
 */
```

åŒæ ·çš„ä»£ç ï¼Œåªæ˜¯åœ¨è°ƒç”¨çš„æ—¶å€™ï¼Œä¸€æ¬¡ä½¿ç”¨äº†`new`æ“ä½œç¬¦æ¥è°ƒç”¨`Person()`å‡½æ•°ï¼Œä¸€æ¬¡æ²¡æœ‰ã€‚ç„¶åè¾“å‡ºçš„æ•ˆæœå¹¶ä¸ç›¸åŒã€‚
ä»`log`å¯ä»¥çœ‹åˆ°ï¼š

* åœ¨å‡½æ•°å¤–éƒ¨ï¼Œ`this`ä¸€ç›´æ˜¯ `Window`ç±»å‹çš„å¯¹è±¡ã€‚ï¼ˆåœ¨å…¨å±€ç¯å¢ƒä¸­è°ƒç”¨çš„ï¼‰[å³ä½¿å‡½æ•°å†…éƒ¨çš„`this`ä¸æ˜¯`Window`ç±»å‹ã€‚]
* åœ¨å‡½æ•°å†…éƒ¨ï¼š
	* å¦‚æœå½“å‰å‡½æ•°è¢«`new funcName(args);`çš„æ–¹å¼è°ƒç”¨ï¼Œ`this`ä¸ºå½“`funcName`ç±»å‹çš„å¯¹è±¡ï¼›
	* å¦‚æœå½“å‰å‡½æ•°æ²¡æœ‰ä½¿ç”¨`new`æ“ä½œç¬¦è°ƒç”¨ï¼Œåªæ˜¯æ™®é€šè°ƒç”¨ï¼ˆ`var result = funcName(args);`ï¼‰ï¼Œåˆ™`this`æ˜¯`Window`ç±»å‹çš„å¯¹è±¡ã€‚

> æ‰€ä»¥ï¼Œé€šè¿‡**æ„é€ å‡½æ•°æ¨¡å¼**ç¡®å®åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œè€Œä¸”ï¼Œè¿™ä¸ªå¯¹è±¡æœ‰è‡ªå·±çš„ç±»å‹ï¼Œå¯ä»¥è¢«ç±»å‹è¯†åˆ«åˆ°äº†ã€‚

åˆ›å»ºè‡ªå®šä¹‰çš„æ„é€ å‡½æ•°æ„å‘³ç€å°†æ¥å¯ä»¥å°†å®ƒçš„å®ä¾‹æ ‡è¯†ä¸ºä¸€ç§ç‰¹å®šçš„ç±»å‹ï¼›è€Œè¿™æ­£æ˜¯æ„é€ å‡½æ•°æ¨¡å¼èƒœè¿‡å·¥å‚æ¨¡å¼çš„åœ°æ–¹ã€‚

> TIPS: ä»¥è¿™ç§æ–¹å¼å®šä¹‰çš„æ„é€ å‡½æ•°æ˜¯å®šä¹‰åœ¨`Global`å¯¹è±¡ï¼ˆåœ¨æµè§ˆå™¨ä¸­æ˜¯`window`å¯¹è±¡ï¼‰ä¸­çš„ã€‚

###### 1.å°†æ„é€ å‡½æ•°å½“ä½œæ™®é€šå‡½æ•°

**æ„é€ å‡½æ•°ä¸å…¶ä»–å‡½æ•°çš„å”¯ä¸€åŒºåˆ«ï¼Œå°±åœ¨äºè°ƒç”¨å®ƒä»¬çš„æ–¹å¼ä¸åŒ**ã€‚ä»»ä½•å‡½æ•°ï¼Œåªè¦é€šè¿‡`new`æ“ä½œç¬¦æ¥è°ƒç”¨ï¼Œé‚£å®ƒå°±å¯ä»¥ä½œä¸ºæ„é€ å‡½æ•°ï¼›è€Œä»»ä½•å‡½æ•°ï¼Œå¦‚æœä¸é€šè¿‡`new`æ“ä½œç¬¦æ¥è°ƒç”¨ï¼Œé‚£å®ƒè·Ÿæ™®é€šå‡½æ•°ä¹Ÿä¸ä¼šæœ‰ä»€ä¹ˆä¸¤æ ·ã€‚

```javascript
// å½“ä½œæ„é€ å‡½æ•°ä½¿ç”¨
var person = new Person("Tom",29,"coder");
person.sayName(); // Tom

// å½“æˆæ™®é€šå‡½æ•°ä½¿ç”¨
Person("Ann",28, "actress");
window.sayName(); // Ann
```
> å½“æˆæ™®é€šå‡½æ•°åï¼Œå°±æŠŠ`name`,`age`è¿™äº›å±æ€§çš„å€¼æ·»åŠ åˆ°å½“å‰æ‰§è¡Œç¯å¢ƒå˜é‡ä¸­å»äº†ï¼Œæ‰€ä»¥`window.name === "Ann"`äº†ã€‚
> 
> ps: æ™®é€šå‡½æ•°çš„`this`å¯¹è±¡ä¸ä¸€å®šæ€»æ˜¯`window`ï¼Œå–å†³äºå½“å‰æ‰§è¡Œç¯å¢ƒã€‚

æ¯”å¦‚ä¸‹é¢è¿™ç§æ“ä½œï¼Œå°†`Person()`å‡½æ•°çš„`this`å¯¹è±¡æŒ‡å®šä¸º`obj`ï¼Œåˆ™åç»­çš„æ·»åŠ å±æ€§çš„æ“ä½œï¼Œä¹Ÿå°±æ˜¯é’ˆå¯¹`obj`äº†ã€‚

```javascript
var obj = {};

Person.apply(obj,['Rose' , 26 , 'writer']);

console.log(obj.sayName() +" ### "+obj.age);
// è¾“å‡ºï¼š Rose ### 26
```

###### 2.æ„é€ å‡½æ•°çš„é—®é¢˜
æ„é€ å‡½æ•°æ¨¡å¼è™½ç„¶è§£å†³äº†ç±»å‹è¯†åˆ«çš„é—®é¢˜ï¼Œä½†æ˜¯æ„é€ å‡½æ•°å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æ¯ä¸ªæ–¹æ³•éƒ½è¦åœ¨æ¯ä¸ªå®ä¾‹ä¸Šé‡æ–°åˆ›å»ºä¸€éã€‚åœ¨å¦‚ä¸‹ä»£ç ï¼ˆé€šè¿‡æ„é€ å‡½æ•°æ¨¡å¼åˆ›å»ºå¯¹è±¡ï¼‰ä¸­ï¼š

```javascript
function Person(name, age, job) {
    this.name = name;
    this.age = age;
    this.job = job;
    this.sayName = function () {
        console.log(this.name);
    };
}

var p1 = new Person("Ann" , 23 , "actress");
var p2 = new Person("Rose" , 23 , "writer");
```
ç»™æ¯ä¸ªå®ä¾‹å¯¹è±¡ï¼ˆ`p1`,`p2`ï¼‰éƒ½åˆ›å»ºäº†ä¸€ä¸ªåä¸º`sayName()`çš„æ–¹æ³•ï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªæ–¹æ³•ä¸æ˜¯åŒä¸€ä¸ª`Function`å®ä¾‹ã€‚**`ECMAScript`ä¸­çš„å‡½æ•°æ˜¯å¯¹è±¡**ï¼Œå› æ­¤æ¯å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å®ä¾‹åŒ–äº†ä¸€ä¸ªå¯¹è±¡ï¼ˆå‡½æ•°å¯¹è±¡ï¼‰ã€‚ä»é€»è¾‘ä¸Šè®²ï¼Œæ­¤æ—¶çš„æ„é€ å‡½æ•°ä¹Ÿå¯ä»¥è¿™æ ·å®šä¹‰ã€‚

```javascript
function Person(name, age, job) {
    this.name = name;
    this.age = age;
    this.job = job;
    this.sayName = new Function("console.log(this.name)");
}

var p1 = new Person("Ann" , 23 , "actress");
var p2 = new Person("Rose" , 23 , "writer");
```
> é€šè¿‡è¿™ç§æ–¹å¼æ›´å®¹æ˜“çœ‹å‡ºï¼Œæ¯åˆ›å»ºä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œéƒ½ä¼šåŒæ—¶åˆ›å»ºä¸€ä¸ªå‡½æ•°å¯¹è±¡ã€‚è¯´æ˜ç™½äº›ï¼Œä»¥è¿™ç§æ–¹å¼åˆ›å»ºå‡½æ•°ï¼Œä¼šå¯¼è‡´ä¸åŒçš„ä½œç”¨åŸŸé“¾å’Œæ ‡ç¤ºç¬¦è§£æï¼Œä½†æ˜¯åˆ›å»º`Function`æ–°å®ä¾‹çš„æœºåˆ¶ä»ç„¶æ˜¯ç›¸åŒçš„ã€‚å› æ­¤ï¼Œä¸åŒå®ä¾‹ä¸Šé¢çš„åŒåå‡½æ•°æ˜¯ä¸ç›¸ç­‰çš„ï¼Œå¦‚ä¸‹ä»£ç å¯ä»¥è¯æ˜è¿™ç‚¹ï¼š

```javascript
console.log(p1.sayName == p2.sayName); // false
```

*æ”¹è¿›æ–¹æ¡ˆï¼š*

```javascript
function Person(name, age, job) {
    this.name = name;
    this.age = age;
    this.job = job;
    this.sayName = inner;
}

function inner(){
	console.log(this.name);
}

var p1 = new Person("Ann" , 23 , "actress");
var p2 = new Person("Rose" , 23 , "writer");
```

é€šè¿‡æŠŠ`sayName()`å‡½æ•°å®šä¹‰è½¬ç§»åˆ°æ„é€ å‡½æ•°å¤–éƒ¨ã€‚è€Œæ„é€ å‡½æ•°å†…éƒ¨ï¼Œå°†`sayName`å±æ€§è®¾ç½®ä¸ºå…¨å±€çš„`inner`å‡½æ•°ã€‚è¿™æ ·çš„ç¡®è§£å†³äº†å¤šä¸ªå¯¹è±¡å®ä¾‹å…±äº«åŒä¸€ä¸ªå‡½æ•°çš„é—®é¢˜ã€‚ä½†æ˜¯ï¼Œå¾ˆæ˜æ˜¾ï¼Œè¿™æ ·çš„ä»£ç è¿‡äºæ¾æ•£ï¼Œå°è£…æ€§ä¸è¶³ã€‚è€Œä¸”`inner()`å‡½æ•°è™½ç„¶åœ¨å…¨å±€å®šä¹‰ï¼Œä½†æ˜¯å®é™…ä¸Šåªæ˜¯è¢«æŸä¸ªå¯¹è±¡è°ƒç”¨ã€‚è€Œä¸”ä¸€æ—¦å¯¹è±¡ä¸­åŒ…å«å¤šä¸ªå‡½æ•°ï¼Œè¿™ç§å†™æ³•å°±ä¸æ¯«æ²¡æœ‰å°è£…æ€§å¯è¨€äº†ã€‚

##### 2.3 åŸå‹æ¨¡å¼

æ¯ä¸ªè¢«åˆ›å»ºçš„å‡½æ•°éƒ½æœ‰ä¸€ä¸ª`prototype`ï¼ˆåŸå‹ï¼‰å±æ€§ï¼Œè¿™ä¸ªå±æ€§æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œ**è¿™ä¸ªå¯¹è±¡çš„ç”¨é€”æ˜¯åŒ…å«å¯ä»¥ç”±ç‰¹å®šç±»å‹çš„æ‰€æœ‰å®ä¾‹å…±äº«çš„å±æ€§å’Œæ–¹æ³•**ã€‚å¦‚æœæŒ‰ç…§å­—é¢æ„æ€æ¥ç†è§£ï¼Œé‚£ä¹ˆ`prototype`å°±æ˜¯é€šè¿‡è°ƒç”¨æ„é€ å‡½æ•°è€Œåˆ›å»ºçš„é‚£ä¸ªå¯¹è±¡å®ä¾‹çš„åŸå‹å¯¹è±¡ã€‚ä½¿ç”¨åŸå‹å¯¹è±¡çš„å¥½å¤„å°±æ˜¯è®©æ‰€æœ‰å¯¹è±¡å®ä¾‹å…±äº«å®ƒæ‰€åŒ…å«çš„å±æ€§å’Œæ–¹æ³•ã€‚æ¢å¥è¯è¯´ï¼Œä¸å¿…å†æ„é€ å‡½æ•°ä¸­å®šä¹‰å¯¹è±¡å®ä¾‹çš„ä¿¡æ¯ï¼Œè€Œæ˜¯å¯ä»¥å°†è¿™äº›ä¿¡æ¯*ç›´æ¥æ·»åŠ åˆ°åŸå‹å¯¹è±¡ä¸­*ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š

```javascript
function Person() {

}

Person.prototype.name = "å¼ æ±¤å§†";
Person.prototype.age = 29;
Person.prototype.job = 'actress';

Person.prototype.sayName = function () {
    console.log(Person.prototype.name);
};


var p1 = new Person();
p1.sayName(); // å¼ æ±¤å§†
p1.name = "æå‰ç±³";
p1.sayName(); // å¼ æ±¤å§†
var p2 = new Person();
p2.sayName(); // å¼ æ±¤å§†
```

åœ¨æ­¤ï¼Œæˆ‘ä»¬å°†`sayName()`æ–¹æ³•å’Œæ‰€æœ‰å±æ€§ç›´æ¥æ·»åŠ åˆ°äº†`Person`çš„`prototype`å±æ€§ä¸­ï¼Œæ„é€ å‡½æ•°å˜æˆäº†ç©ºå‡½æ•°ã€‚å³ä½¿å¦‚æ­¤ï¼Œä¹Ÿä»ç„¶å¯ä»¥é€šè¿‡è°ƒç”¨æ„é€ å‡½æ•°æ¥åˆ›å»ºæ–°å¯¹è±¡ï¼Œè€Œä¸”æ–°å¯¹è±¡è¿˜ä¼šå…·æœ‰ç›¸åŒçš„å±æ€§å’Œæ–¹æ³•ã€‚ä½†**ä¸æ„é€ å‡½æ•°æ¨¡å¼ä¸åŒçš„æ˜¯**ï¼Œæ–°å¯¹è±¡çš„è¿™äº›å±æ€§å’Œæ–¹æ³•æ˜¯ç”±æ‰€æœ‰å®ä¾‹å…±äº«çš„ã€‚æ¢å¥è¯è¯´ï¼Œ`person1`å’Œ`person2`è®¿é—®çš„éƒ½æ˜¯åŒä¸€ç»„å±æ€§å’ŒåŒä¸€ä¸ª`sayName()`å‡½æ•°ã€‚è¦ç†è§£åŸå‹æ¨¡å¼çš„å·¥ä½œåŸç†ï¼Œå¿…é¡»å…ˆç†è§£`ECMAScript`ä¸­åŸå‹å¯¹è±¡çš„æ€§è´¨ã€‚

###### 1 ç†è§£åŸå‹å¯¹è±¡

**æ— è®ºä»€ä¹ˆæ—¶å€™ï¼Œåªè¦åˆ›å»ºäº†ä¸€ä¸ªæ–°å‡½æ•°ï¼Œå°±ä¼šæ ¹æ®ä¸€ç»„ç‰¹å®šçš„è§„åˆ™ä¸ºè¯¥å‡½æ•°åˆ›å»ºä¸€ä¸ª`prototype`å±æ€§ï¼Œè¿™ä¸ªå±æ€§æŒ‡å‘å‡½æ•°çš„åŸå‹å¯¹è±¡**ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰åŸå‹å¯¹è±¡éƒ½ä¼šè‡ªåŠ¨è·å¾—ä¸€ä¸ª`constructor`ï¼ˆæ„é€ å‡½æ•°ï¼‰å±æ€§ï¼Œè¿™ä¸ªå±æ€§åŒ…å«ä¸€ä¸ªæŒ‡å‘`prototype`å±æ€§æ‰€åœ¨å‡½æ•°çš„æŒ‡é’ˆã€‚è€Œé€šè¿‡è¿™ä¸ªæ„é€ å‡½æ•°ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç»§ç»­ä¸ºåŸå‹å¯¹è±¡æ·»åŠ å…¶ä»–çš„å±æ€§å’Œæ–¹æ³•ã€‚

> åŸå‹å¯¹è±¡æœ‰ä¸€ä¸ª`constructor`å±æ€§ï¼ŒæŒ‡å‘è¯¥åŸå‹å¯¹è±¡å¯¹åº”çš„æ„é€ å‡½æ•°

```javascript
function Foo(){};
console.log(Foo.prototype.constructor === Foo);//true
```

> ç”±äºå®ä¾‹å¯¹è±¡å¯ä»¥ç»§æ‰¿åŸå‹å¯¹è±¡çš„å±æ€§ï¼Œæ‰€ä»¥å®ä¾‹å¯¹è±¡ä¹Ÿæ‹¥æœ‰`constructor`å±æ€§ï¼ŒåŒæ ·æŒ‡å‘åŸå‹å¯¹è±¡å¯¹åº”çš„æ„é€ å‡½æ•°

```javascript
function Foo(){};
var f1 = new Foo;
console.log(f1.constructor === Foo);//true
```

> å®ä¾‹å¯¹è±¡æœ‰ä¸€ä¸ª`proto`å±æ€§ï¼ŒæŒ‡å‘è¯¥å®ä¾‹å¯¹è±¡å¯¹åº”çš„åŸå‹å¯¹è±¡

```javascript
function Foo(){};
var f1 = new Foo;
console.log(f1.__proto__ === Foo.prototype);//true
```
åˆ›å»ºäº†è‡ªå®šä¹‰çš„çš„æ„é€ å‡½æ•°ä¹‹åï¼Œå…¶åŸå‹å¯¹è±¡é»˜è®¤åªä¼šå–å¾—`constructor`å±æ€§ï¼›è‡³äºå…¶ä»–æ–¹æ³•ï¼Œåˆ™éƒ½æ˜¯ä»`Object`ç»§æ‰¿è¿‡æ¥çš„ã€‚å½“è°ƒç”¨æ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹åï¼Œè¯¥å®ä¾‹çš„å†…éƒ¨å°†åŒ…å«ä¸€ä¸ªæŒ‡é’ˆï¼ˆå†…éƒ¨å±æ€§ï¼‰ï¼ŒæŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ã€‚`ECMA-262`ç¬¬5ç‰ˆä¸­ç®¡è¿™ä¸ªæŒ‡é’ˆå«`[[Prototype]]`ã€‚è™½ç„¶åœ¨è„šæœ¬ä¸­æ²¡æœ‰æ ‡å‡†çš„æ–¹å¼è®¿é—®`[[Prototype]]`ï¼Œä½†`Firefox`ã€`Safari`å’Œ`Chrome`åœ¨æ¯ä¸ªå¯¹è±¡ä¸Šéƒ½æ”¯æŒä¸€ä¸ªå±æ€§`__proto__`ï¼›è€Œåœ¨å…¶ä»–å®ç°ä¸­ï¼Œè¿™å±æ€§å¯¹è„šæœ¬æ˜¯å®Œå…¨ä¸å¯è§çš„ã€‚ä¸è¿‡ï¼Œè¦æ˜ç¡®çš„çœŸæ­£é‡è¦çš„ä¸€ç‚¹å°±æ˜¯ï¼Œ**è¿™ä¸ªè¿æ¥å­˜åœ¨äºå®ä¾‹ä¸æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ä¹‹é—´ï¼Œè€Œä¸æ˜¯å­˜åœ¨äºå®ä¾‹ä¸æ„é€ å‡½æ•°ä¹‹é—´**ã€‚

è™½ç„¶åœ¨æ‰€æœ‰çš„å®ç°ä¸­éƒ½æ— æ³•è®¿é—®åˆ°`[[Prototype]]`ï¼Œä½†å¯ä»¥é€šè¿‡`isPrototyeOf()`æ–¹æ³•æ¥ç¡®å®šå¯¹è±¡ä¹‹é—´æ˜¯å¦å­˜åœ¨è¿™ç§å…³ç³»ã€‚ä»æœ¬è´¨ä¸Šè®²ï¼Œå¦‚æœ`[[Prototype]]`æŒ‡å‘è°ƒç”¨`isPrototypeOf()`æ–¹æ³•çš„å¯¹è±¡ï¼ˆ`Person.prototype`ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•å°±è¿”å›`true`ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```javascript
function Duck(){}
var du = new Duck();

console.info(Duck.isPrototypeOf(du)); // false 
console.info(Duck.prototype.isPrototypeOf(du)); // true

// -------------------------

console.info(du.__proto__ == Duck.prototype); // true
console.info(du.constructor == Duck); // true
console.info(du.__proto__ 
== Duck.prototype.constructor.prototype); // true
```
`ECMAScript5`å¢åŠ äº†ä¸€ä¸ªæ–°æ–¹æ³•ï¼Œå«`Object.getPrototypeOf()`ï¼Œåœ¨æ‰€æœ‰æ”¯æŒçš„å®ç°ä¸­ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›`[[Prototype]]`çš„å€¼ã€‚ä¾‹å¦‚ï¼š

```javascript
console.info(du.__proto__ == Duck.prototype 
&& Object.getPrototypeOf(du) == du.__proto__); // true
```

> `Object.getPrototypeOf(du)`å®é™…ä¸Šå°±æ˜¯`du.__proto__`ã€‚
> 
> åªä¸è¿‡ï¼Œåœ¨éƒ¨åˆ†æµè§ˆå™¨ä¸­ä¸æ”¯æŒ`__proto__`å±æ€§ã€‚

æ¯å½“ä»£ç è¯»å–æŸä¸ªå¯¹è±¡çš„æŸä¸ªå±æ€§æ—¶ï¼ˆæ¯”å¦‚ï¼š`per.name`è¿™ç§ï¼‰ï¼Œéƒ½ä¼šæ‰§è¡Œä¸€æ¬¡æœç´¢ï¼Œç›®æ ‡æ˜¯å…·æœ‰ç»™å®šåå­—çš„å±æ€§ã€‚æœç´¢é¦–å…ˆä»å¯¹è±¡å®ä¾‹æœ¬èº«å¼€å§‹ã€‚å¦‚æœåœ¨å®ä¾‹ä¸­æ‰¾åˆ°äº†å…·æœ‰ç»™å®šåå­—çš„å±æ€§ï¼Œåˆ™è¿”å›è¯¥å±æ€§çš„å€¼ï¼›å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™ç»§ç»­æœç´¢æŒ‡é’ˆæŒ‡å‘çš„åŸå‹å¯¹è±¡ï¼Œåœ¨åŸå‹å¯¹è±¡ä¸­æŸ¥æ‰¾å…·æœ‰ç»™å®šåå­—çš„å±æ€§ã€‚å¦‚æœåœ¨åŸå‹å¯¹è±¡ä¸­æ‰¾åˆ°äº†è¿™ä¸ªå±æ€§ï¼Œåˆ™è¿”å›è¯¥å±æ€§çš„å€¼ã€‚`todo:::`

è™½ç„¶å¯ä»¥é€šè¿‡å¯¹è±¡å®ä¾‹è®¿é—®ä¿å­˜åœ¨åŸå‹ä¸­çš„å€¼ï¼Œä½†å´ä¸èƒ½é€šè¿‡å¯¹è±¡å®ä¾‹é‡å†™åŸå‹ä¸­çš„å€¼ã€‚å¦‚æœæˆ‘ä»¬åœ¨å®ä¾‹ä¸­æ·»åŠ äº†ä¸€ä¸ªå±æ€§ï¼Œè€Œè¯¥å±æ€§ä¸å®ä¾‹åŸå‹ä¸­çš„ä¸€ä¸ªå±æ€§åŒåï¼Œé‚£å®ä¾‹ä¸­çš„å±æ€§å°†ä¼šå±è”½åŸå‹ä¸­çš„é‚£ä¸ªå±æ€§ã€‚

```javascript
function Lemon(){}

Lemon.prototype.username = 'Ann';

var m1 = new Lemon();
m1.username = 'Stone';
var m2 = new Lemon();
console.log(m1.username +" ## "+m2.username); // Stone ## Ann
```
å½“ä¸ºå¯¹è±¡å®ä¾‹æ·»åŠ ä¸€ä¸ªå±æ€§æ—¶ï¼Œè¿™ä¸ªå±æ€§ä¼š**å±è”½**åŸå‹å¯¹è±¡ä¸­ä¿å­˜çš„åŒåå±æ€§ï¼›æˆ–è€…è¯´ï¼Œæ·»åŠ è¿™ä¸ªå±æ€§åªä¼šé˜»æ­¢æˆ‘ä»¬è®¿é—®åŸå‹ä¸­çš„é‚£ä¸ªå±æ€§ï¼Œä½†ä¸ä¼šä¿®æ”¹é‚£ä¸ªå±æ€§ã€‚å³ä½¿å°†è¿™ä¸ªå±æ€§è®¾ç½®ä¸º`null`ï¼Œä¹Ÿåªä¼šåœ¨å®ä¾‹ä¸­è®¾ç½®äº†è¿™ä¸ªå±æ€§ï¼Œè€Œä¸ä¼šæ¢å¤å…¶æŒ‡å‘åŸå‹çš„è¿æ¥ã€‚ï¼ˆè®¿é—® `m1.username`è¿”å›äº†`null`ï¼Œä½†æ˜¯`m1.username`ä¾ç„¶å­˜åœ¨ï¼Œä¾ç„¶èµ·åˆ°äº†é˜»æ­¢è®¿é—®åŸå‹å¯¹è±¡çš„åŒåå±æ€§çš„æ•ˆæœï¼‰ã€‚ä¸è¿‡ï¼Œå¦‚æœä½¿ç”¨`delete`æ“ä½œç¬¦ï¼Œåˆ é™¤äº†è¿™ä¸ªå®ä¾‹å±æ€§ï¼ˆ`delete m1.username`ï¼‰ï¼Œåˆ™èƒ½å¤Ÿå†æ¬¡è®¿é—®åŸå‹ä¸­çš„å±æ€§äº†ã€‚å¦‚ä¸‹ï¼š

```javascript
function Lemon(){}

Lemon.prototype.username = 'Ann';

var m1 = new Lemon();
m1.username = 'Stone';
console.log(m1.username); // Stone
m1.username = null;
console.log(m1.username); // null

delete m1.username
console.log(m1.username); // Ann
```

ä½¿ç”¨`hasOwnPrototype()`æ–¹æ³•å¯ä»¥æ£€æµ‹ä¸€ä¸ªå±æ€§æ˜¯å­˜åœ¨äºå®ä¾‹ä¸­ï¼Œè¿˜æ˜¯å­˜åœ¨äºåŸå‹ä¸­ã€‚è¿™ä¸ªæ–¹æ³•ï¼ˆç»§æ‰¿è‡ª`Object`ï¼‰åªåœ¨ç»™å®šå±æ€§å­˜åœ¨çš„å¯¹è±¡å®ä¾‹ä¸­æ—¶ï¼Œæ‰ä¼šè¿”å›`true`ã€‚å¦‚ä¸‹ï¼š

```javascript
function Panda() {
    this.age = 3;
}

Panda.prototype.usename = "Ann";

var p1 = new Panda();

p1.gender = 'female';
console.log(p1.hasOwnProperty('gender')); // true
console.log(p1.hasOwnProperty('name')); // false
console.log(p1.hasOwnProperty('age')); // true

p1.usename = "Rose";
console.log(p1.hasOwnProperty('name')); // true
```

###### 2 åŸå‹ä¸`in`æ“ä½œç¬¦

æœ‰ä¸¤ç§æ–¹å¼ä½¿ç”¨`in`æ“ä½œç¬¦ï¼šå•ç‹¬ä½¿ç”¨å’Œåœ¨`for-in`å¾ªç¯ä¸­ä½¿ç”¨ã€‚åœ¨å•ç‹¬ä½¿ç”¨æ—¶ï¼Œ`in`æ“ä½œç¬¦ä¼šåœ¨é€šè¿‡å¯¹è±¡èƒ½å¤Ÿè¿”å›ç»™å®šå±æ€§æ—¶è¿”å›`true`ï¼Œæ— è®ºè¯¥å±æ€§å­˜åœ¨äºå®ä¾‹ä¸­è¿˜æ˜¯åŸå‹ä¸­ã€‚å¦‚ä¸‹ï¼š

> åˆ¤æ–­ä¸€ä¸ªå±æ€§æ˜¯å­˜åœ¨äºå®ä¾‹ä¸­è¿˜æ˜¯å®ä¾‹çš„åŸå‹ä¸­

```javascript

// åˆ¤æ–­ä¸€ä¸ªå±æ€§æ˜¯å¦æ˜¯åªå­˜åœ¨äºåŸå‹ä¸­
function onlyInPrototype(obj, propName) {
    return (propName in obj)
        && !obj.hasOwnProperty(propName);
}

// åˆ¤æ–­ä¸€ä¸ªå±æ€§æ˜¯å¦æ˜¯åªå­˜åœ¨äºå®ä¾‹ä¸­(todo: å¾…å®Œå–„)
function onlyInInstance(obj, propName) {
    return obj.hasOwnProperty(propName)
        && !( propName in obj.constructor.prototype);
} // è¿™ä¸ªæ–¹æ³•æœ‰é—®é¢˜ï¼Œå› ä¸ºåŸå‹ä¾ç„¶ä¼šæœ‰åŸå‹ï¼Œé™¤éä¸€ç›´è¿½æº¯åˆ° null

```

è¦å–å¾—å¯¹è±¡ä¸Šæ‰€æœ‰å¯æšä¸¾çš„å®ä¾‹å±æ€§ï¼Œå¯ä»¥ä½¿ç”¨`ECMAScript5`çš„`Object.keys()`æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å¯æšä¸¾å±æ€§çš„å­—ç¬¦ä¸²æ•°ç»„ã€‚ï¼ˆ**äº²æµ‹æ•ˆæœä¸å¥½ï¼Œå¯¹äºå®šä¹‰åœ¨`prototype`ä¸­çš„å±æ€§ï¼Œä¸ä¼šåŒ…å«åœ¨å…¶ä¸­**ï¼‰å¦‚ä¸‹ï¼š

```javascript
function Panda() {
    this.age = 3;
}
Panda.prototype.username = "Ann";

var p1 = new Panda();
p1.gender = 'female';

console.log(Object.keys(p1));
```
> è¾“å‡ºå¦‚ä¸‹ï¼š

`["age", "gender"]`

å¦‚æœä½ æƒ³è¦å¾—åˆ°å®ä¾‹çš„æ‰€æœ‰å±æ€§ï¼Œæ— è®ºå®ƒæ˜¯å¦å¯ä»¥æšä¸¾ï¼Œéƒ½å¯ä»¥é€šè¿‡`Object.getOwnPropertyNames()`æ–¹æ³•å¾—åˆ°ã€‚**äº²æµ‹æ•ˆæœä¸å¥½ï¼Œå¯¹äºå½“å‰å®ä¾‹çš„åŸå‹ä¸­å®šä¹‰çš„å±æ€§ï¼Œå¹¶ä¸èƒ½å¾—åˆ°ã€‚**

> *è¿˜æ˜¯`for-in`æ¯”è¾ƒå¥½*

###### 3 æ›´ç®€å•çš„åŸå‹è¯­æ³•

```javascript

function Panda() {
}
Panda.prototype = {
    name: "Ann",
    'age': 5,
    job: 'actress',
    sayName: function () {
        console.info(this.name + " this ? " + (this instanceof Panda));

    }
};
```
ä½†æ˜¯ï¼Œè¿™æ ·å†™ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œè¿™é‡Œå°†`Panda.proptotype`è®¾ç½®ä¸ºä¸€ä¸ªå­—é¢é‡å½¢å¼çš„æ–°å¯¹è±¡ï¼Œæœ¬è´¨ä¸Šå®Œå…¨é‡å†™äº†é»˜è®¤çš„`prototype`å¯¹è±¡ã€‚è€Œæ¯ä¸ªåˆ›å»ºçš„å‡½æ•°ï¼Œéƒ½ä¼šä¸€ä¸ªåŒæ—¶è¢«åˆ›å»ºçš„`prototype`å¯¹è±¡ï¼Œè€Œè¿™ä¸ª`prototype`å¯¹è±¡ä¹Ÿä¼šè‡ªåŠ¨è·å–`constructor`å±æ€§ã€‚æ¢å¥è¯è¯´ï¼Œ**è¿™ç§å­—é¢é‡å½¢å¼åˆ›å»ºçš„`prototype`å±æ€§ï¼Œä¼šä¸¢å¤±å…¶é»˜è®¤çš„`constructor`å±æ€§ã€‚**

> çœ‹ä¸€ä¸‹è¿™ç§æ–¹å¼å¸¦æ¥çš„åæœï¼š

```javascript
function Panda() {
}
Panda.prototype = {
    name: "Ann",
    'age': 5,
    job: 'actress'
};
var p1 = new Panda();
console.log(p1.constructor === Panda); // false

function Lemon() {

}

Lemon.prototype.name = 'rose';
Lemon.prototype.job = 'writer';

var m = new Lemon();

console.log(m.constructor === Lemon); // true
```
> ä» `console.log(p1.constructor === Panda); // false`å¯ä»¥çœ‹åˆ°ï¼Œçš„ç¡®ä¸¢å¤±`constructor`å±æ€§ã€‚è¿™ä¸ª`constructor`æ˜¯ç»§æ‰¿è‡ª`Object`çš„ï¼Œæ‰€ä»¥æŒ‡å‘çš„ä¹Ÿå°±æˆäº†`Object`äº†ã€‚

*æ”¹è¿›æ–¹æ¡ˆï¼š*

```javascript
function Panda() {
}
Panda.prototype = {
    constructor: Panda, 
    // æ‰‹åŠ¨æ·»åŠ  constructor å±æ€§ ï¼Œ ä¼šå¯¼è‡´ enumerable ä¸º true
    name: "Ann",
    'age': 5,
    job: 'actress'
};
var p1 = new Panda();
console.log(p1.constructor === Panda); // true
```
è¿™ç§æ–¹å¼é‡è®¾`constructor`å±æ€§ä¼šå¯¼è‡´å®ƒçš„`[[Enumerable]]`å±æ€§è¢«è®¾ç½®ä¸º`true`ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŸç”Ÿçš„`constructor`å±æ€§æ˜¯ä¸å¯æšä¸¾çš„ã€‚

*æ”¹è¿›æ–¹æ¡ˆ2ï¼šï¼ˆæ— å‰¯ä½œç”¨äº†...ï¼‰*

```javascript
function Panda() {
}
Panda.prototype = {
    // constructor: Panda,
    name: "Ann",
    'age': 5,
    job: 'actress'
};

Object.defineProperty(Panda.prototype, "constructor", {
    enumerable: false,
    value: Panda
});
var p1 = new Panda();
console.log(p1.constructor === Panda); // true

```

###### 4 åŸå‹çš„åŠ¨æ€æ€§

ç”±äºåœ¨åŸå‹ä¸­æŸ¥æ‰¾å€¼çš„è¿‡ç¨‹æ˜¯ä¸€æ¬¡æœç´¢ï¼Œå› æ­¤æˆ‘ä»¬å¯¹åŸå‹å¯¹è±¡æ‰€åšçš„ä»»ä½•ä¿®æ”¹éƒ½èƒ½å¤Ÿç«‹å³ä»å®ä¾‹ä¸Šåæ˜ å‡ºæ¥--å³ä½¿æ˜¯å…ˆåˆ›å»ºäº†å®ä¾‹åä¿®æ”¹åŸå‹ä¹Ÿæ˜¯å¦‚æ­¤ã€‚å¦‚ä¸‹ï¼š

```javascript
function Person() {

}

var p1 = new Person();

Person.prototype.sayHi = function () {
    console.log("Hi");
};

p1.sayHi(); // æ­£å¸¸è¾“å‡º

```
ä»¥ä¸Šä»£ç å…ˆåˆ›å»ºäº†`Person`å®ä¾‹ï¼ˆ`p1`ï¼‰ï¼Œå¹¶å°†å…¶ä¿å­˜åœ¨`p1`ä¸­ã€‚ç„¶åï¼Œä¸‹ä¸€æ¡è¯­å¥åœ¨`Person.prototype`ä¸­æ·»åŠ äº†ä¸€ä¸ªæ–¹æ³•`sayHi()`ã€‚å³ä½¿`p1`å®ä¾‹æ˜¯åœ¨**æ·»åŠ **æ–°æ–¹æ³•ä¹‹å‰åˆ›å»ºçš„ï¼Œä½†å®ƒä»ç„¶å¯ä»¥è®¿é—®è¿™ä¸ªæ–°çš„æ–¹æ³•ã€‚å…¶åŸå› å¯ä»¥å½’ç»“ä¸ºå®ä¾‹ä¸åŸå‹ä¹‹é—´çš„æ¾æ•£è¿æ¥å…³ç³»ã€‚å½“æˆ‘ä»¬è°ƒç”¨`person.sayHi()`æ—¶ï¼Œé¦–å…ˆä¼šåœ¨å®ä¾‹ä¸­æœç´¢åä¸º`sayHi()`çš„å±æ€§ï¼Œåœ¨æ²¡æœ‰æ‰¾åˆ°çš„æƒ…å†µä¸‹ï¼Œä¼šç»§ç»­æœç´¢åŸå‹ã€‚å› ä¸ºå®ä¾‹ä¸åŸå‹ä¹‹é—´çš„è¿æ¥åªä¸è¿‡æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œè€Œéå‰¯æœ¬ï¼Œå› æ­¤å°±å¯ä»¥åœ¨åŸå‹ä¸­æ‰¾åˆ°æ–°çš„`sayHi()`å±æ€§å¹¶è¿”å›ä¿å­˜åœ¨é‚£é‡Œçš„å‡½æ•°ã€‚

å°½ç®¡å¯ä»¥éšæ—¶ä¸ºåŸå‹æ·»åŠ å±æ€§å’Œæ–¹æ³•ï¼Œå¹¶ä¸”ä¿®æ”¹èƒ½å¤Ÿç«‹å³åœ¨æ‰€æœ‰å¯¹è±¡å®ä¾‹ä¸­åæ˜ å‡ºæ¥ï¼Œ**ä½†å¦‚æœæ˜¯é‡å†™æ•´ä¸ªåŸå‹å¯¹è±¡ï¼Œé‚£ä¹ˆæƒ…å†µå°±ä¸ä¸€æ ·äº†ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œè°ƒç”¨æ„é€ å‡½æ•°æ—¶ä¼šä¸ºå®ä¾‹æ·»åŠ ä¸€ä¸ªæŒ‡å‘æœ€åˆåŸå‹çš„`[[Prototype]]`æŒ‡é’ˆï¼Œè€ŒæŠŠåŸå‹ä¿®æ”¹ä¸ºå¦ä¸€ä¸ªå¯¹è±¡å°±ç­‰äºåˆ‡æ–­äº†æ„é€ å‡½æ•°ä¸æœ€åˆåŸå‹ä¹‹é—´çš„è”ç³»ã€‚**è¯·è®°ä½ï¼šå®ä¾‹ä¸­çš„æŒ‡é’ˆä»…æŒ‡å‘åŸå‹ï¼Œè€Œä¸æŒ‡å‘æ„é€ å‡½æ•°ã€‚å¦‚ä¸‹ï¼š

```javascript

function Person(){}
var p1 = new Person();
Person.prototype = {
    sayHi: function(){
        console.log('Hi');
    }
};
p1.sayHi(); // TypeError: p1.sayHi is not a function
```
åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬å…ˆåˆ›å»ºäº†`Person`çš„ä¸€ä¸ªå®ä¾‹ï¼Œç„¶ååˆé‡å†™äº†å…¶åŸå‹å¯¹è±¡ã€‚ç„¶åå†è°ƒç”¨`p1.sayHi()`æ—¶å‘ç”Ÿäº†é”™è¯¯ï¼Œå› ä¸º`p1`æŒ‡å‘çš„åŸå‹ä¸­ä¸åŒ…å«ä»¥è¯¥åå­—å‘½åçš„å±æ€§ã€‚é‡å†™åŸå‹å¯¹è±¡åˆ‡æ–­äº†ç°æœ‰åŸå‹ä¸ä»»ä½•ä¹‹å‰å·²ç»å­˜åœ¨çš„å¯¹è±¡å®ä¾‹ä¹‹é—´çš„è”ç³»ï¼Œå®ƒä»¬å¼•ç”¨çš„ä»ç„¶æ˜¯æœ€åˆçš„åŸå‹ã€‚

###### 5 åŸç”Ÿå¯¹è±¡çš„åŸå‹

æ‰€æœ‰åŸç”Ÿçš„å¼•ç”¨ç±»å‹ï¼Œéƒ½æ˜¯é‡‡ç”¨åŸå‹æ¨¡å¼åˆ›å»ºçš„ã€‚æ‰€æœ‰çš„åŸç”Ÿå¼•ç”¨ç±»å‹ï¼ˆ`Object`ï¼Œ`Array`ï¼Œ`String`ï¼Œç­‰ç­‰ï¼‰éƒ½åœ¨å…¶æ„é€ å‡½æ•°çš„åŸå‹ä¸Šå®šä¹‰äº†æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œåœ¨`Array.prototype`ä¸­å¯ä»¥æ‰¾åˆ°`sort()`æ–¹æ³•ï¼Œè€Œåœ¨`String.prototype`ä¸­å¯ä»¥æ‰¾åˆ°`substring()`æ–¹æ³•ã€‚å¦‚ä¸‹ï¼š

```javascript
console.log(typeof Array.prototype.sort);
console.log(typeof String.prototype.substring);
```

ç”±äºåŸå‹çš„åŠ¨æ€æ€§ï¼Œæ‰€æœ‰å¯ä»¥åƒä¿®æ”¹è‡ªå®šä¹‰å¯¹è±¡çš„åŸå‹ä¸€æ ·ä¿®æ”¹åŸç”Ÿå¯¹è±¡çš„åŸå‹ï¼Œæ¯”å¦‚ï¼Œç»™åŸç”Ÿå¯¹è±¡çš„åŸå‹æ·»åŠ ä¸€ä¸ªæ–¹æ³•ã€‚å¦‚ä¸‹ï¼š

```javascript

String.prototype.startWith = function (key) {
    return this.indexOf(key) === 0
};

var sw = "abcde".startWith('abc');
console.log(sw); // true

var sq = "zabcde".startWith('abc');
console.log(sq); // false
```
> è™½ç„¶å¯ä»¥åŠ¨æ€ä¿®æ”¹åŸç”Ÿå¯¹è±¡çš„åŸå‹ï¼Œä½†æ˜¯ä¸å»ºè®®è¿™æ ·åšã€‚

###### 6 åŸå‹å¯¹è±¡çš„é—®é¢˜

åŸå‹æ¨¡å¼é¦–å…ˆå¿½ç•¥äº†ä¸ºæ„é€ å‡½æ•°ä¼ é€’åˆå§‹åŒ–å‚æ•°çš„è¿™ä¸€ç¯èŠ‚ï¼Œç»“æœæ‰€æœ‰çš„å®ä¾‹åœ¨é»˜è®¤æƒ…å†µä¸‹éƒ½è®²å–å¾—ç›¸åŒçš„å±æ€§å€¼ã€‚è™½ç„¶è¿™ä¼šåœ¨æŸç§ç¨‹åº¦ä¸Šå¸¦æ¥ä¸€äº›ä¸æ–¹ä¾¿ï¼Œä½†æ˜¯è¿™è¿˜ä¸æ˜¯åŸå‹çš„æœ€å¤§é—®é¢˜ã€‚åŸå‹æ¨¡å¼çš„æœ€å¤§é—®é¢˜æ˜¯ç”±å…¶å…±äº«çš„æœ¬æ€§æ‰€å¯¼è‡´çš„ã€‚

åŸå‹ä¸­æ‰€æœ‰å±æ€§æ˜¯è¢«å¾ˆå¤šå®ä¾‹å…±äº«çš„ï¼Œè¿™ç§å…±äº«å¯¹äºå‡½æ•°éå¸¸åˆé€‚ã€‚å¯¹äºé‚£äº›åŒ…å«åŸºæœ¬å€¼çš„å±æ€§å€’ä¹Ÿè¯´å¾—è¿‡å»ï¼Œå› ä¸ºè¿™äº›å€¼æ˜¯ç«‹å³ä¿®æ”¹çš„ï¼ˆå€¼ä¼ é€’ï¼‰ã€‚ç„¶è€Œï¼Œå¯¹äºåŒ…å«å¼•ç”¨ç±»å‹çš„å€¼çš„å±æ€§æ¥è¯´ï¼Œé—®é¢˜å°±æ¯”è¾ƒçªå‡ºã€‚å¦‚ä¸‹ï¼š

```javascript
function Person(){}

Person.prototype.colors = ['red'];

var p1 = new Person();
p1.colors.push('blue');
console.log(p1.colors); // red,blue

var p2 = new Person();
console.log(p2.colors); // red,blue

console.log(p1.colors === p2.colors); // true
```
> å¯ä»¥çœ‹åˆ°ï¼Œ`p1`ä¿®æ”¹äº†`colors`å±æ€§ï¼Œå¯¼è‡´`p2`çš„`colors`ä¹Ÿè¢«ä¿®æ”¹äº†ã€‚ï¼ˆå› ä¸ºå®é™…ä¸Šä¸¤ä¸ªå®ä¾‹å¯¹è±¡ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ª`colors`å±æ€§ï¼‰

æ¯ä¸ªå®ä¾‹å¯¹è±¡ä¸€èˆ¬éƒ½æ˜¯è¦ç”±å±äºè‡ªå·±çš„å…¨éƒ¨çš„å±æ€§çš„ï¼ˆä¸èƒ½è¢«å…¶ä»–å®ä¾‹ä¿®æ”¹çš„å±æ€§ï¼‰ã€‚è€Œè¿™ä¸ªé—®é¢˜æ­£æ˜¯æˆ‘ä»¬å¾ˆå°‘çœ‹åˆ°æœ‰äººå•ç‹¬ä½¿ç”¨åŸå‹æ¨¡å¼çš„åŸå› æ‰€åœ¨ã€‚

##### 2.4 ç»„åˆç»§æ‰¿

> ç»„åˆä½¿ç”¨*æ„é€ å‡½æ•°æ¨¡å¼*å’Œ*åŸå‹æ¨¡å¼*

**åˆ›å»ºè‡ªå®šä¹‰ç±»å‹çš„æœ€å¸¸è§çš„æ–¹å¼ï¼Œå°±æ˜¯ç»„åˆä½¿ç”¨æ„é€ å‡½æ•°æ¨¡å¼ä¸åŸå‹æ¨¡å¼**ã€‚*æ„é€ å‡½æ•°æ¨¡å¼ç”¨äºå®šä¹‰å®ä¾‹å±æ€§ï¼Œè€ŒåŸå‹æ¨¡å¼ç”¨äºå®šä¹‰æ–¹æ³•å’Œå…±äº«çš„å±æ€§*ã€‚ç»“æœï¼Œæ¯ä¸ªå®ä¾‹éƒ½ä¼šæœ‰è‡ªå·±çš„ä¸€ä»½å®ä¾‹å±æ€§çš„åˆ†å¸ƒï¼Œä½†åŒæ—¶åˆå…±äº«ç€å¯¹æ–¹æ³•çš„å¼•ç”¨ï¼Œæœ€å¤§é™åº¦åœ°èŠ‚çœäº†å†…å­˜ã€‚å¦å¤–ï¼Œè¿™ç§æ··åˆæ¨¡å¼è¿˜æ”¯æŒå‘æ„é€ å‡½æ•°ä¼ é€’å‚æ•°ï¼›å¯è°“æ˜¯é›†ä¸¤ç§æ¨¡å¼ä¹‹é•¿ã€‚å¦‚ä¸‹ï¼š

```javascript
function Person(name, age, job) {
    this.name = name;
    this.age = age;
    this.job = job;
}

Person.prototype.sayName = function () {
    console.log(this.name);
};

Person.prototype.friends = ['Dogs', 'Cats'];

var p1 = new Person('Rose', 29, 'writer');
var p2 = new Person('Ann', 29, 'actress');

p1.sayName();
p2.sayName();
console.log(p1);
console.log(p2);
console.log(p1.friends);
```
> è¾“å‡ºå¦‚ä¸‹ï¼š

```
Rose
Ann
Person { name: 'Rose', age: 29, job: 'writer' }
Person { name: 'Ann', age: 29, job: 'actress' }
[ 'Dogs', 'Cats' ]

```

ä¸Šé¢çš„ä»£ç ä¹Ÿå¯ä»¥è¿™æ ·å†™ï¼š

```javascript
function Person(name, age, job) {
    this.name = name;
    this.age = age;
    this.job = job;
}

Person.prototype = {
    constructor: Person, 
    // è¿™ä¸€å¥ä¸èƒ½å°‘ï¼Œä¸ç„¶`constructor`å°±æˆäº†`Object`
    sayName: function () {
        console.log(this.name);
    },
    friends: ['Dogs', 'Cats']
};

var p1 = new Person('Rose', 29, 'writer');
var p2 = new Person('Ann', 29, 'actress');

p1.sayName();
p2.sayName();
console.log(p1);
console.log(p2);
console.log(p1.friends);

```
åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œå®ä¾‹å±æ€§éƒ½æ˜¯åœ¨æ„é€ å‡½æ•°ä¸­å®šä¹‰çš„ï¼Œè€Œç”±æ‰€æœ‰å®ä¾‹å…±äº«çš„å±æ€§ï¼ˆ`constructor`,`friedns`ï¼‰å’Œæ–¹æ³•(`sayName()`)åˆ™æ˜¯åœ¨åŸå‹ä¸­å®šä¹‰çš„ã€‚

**è¿™ç§æ„é€ å‡½æ•°ä¸åŸå‹æ··æˆçš„æ¨¡å¼ï¼Œæ˜¯ç›®å‰åœ¨`ECMAScript`ä¸­ä½¿ç”¨æœ€å¹¿æ³›ã€è®¤åŒåº¦æœ€é«˜çš„ä¸€ç§åˆ›å»ºè‡ªå®šä¹‰ç±»å‹çš„æ–¹æ³•**ã€‚å¯ä»¥è¯´ï¼Œ**è¿™æ˜¯ç”¨æ¥å®šä¹‰å¼•ç”¨ç±»å‹çš„ä¸€ç§é»˜è®¤æ¨¡å¼ã€‚**

##### 2.5 åŠ¨æ€åŸå‹æ¨¡å¼

æœ‰å…¶ä»–`OOP`è¯­è¨€ç»éªŒçš„å¼€å‘äººå‘˜çœ‹åˆ°ç‹¬ç«‹çš„æ„é€ å‡½æ•°å’ŒåŸå‹æ—¶ï¼Œå¾ˆå¯èƒ½ä¼šæ„Ÿåˆ°å›°æƒ‘ã€‚*åŠ¨æ€åŸå‹æ¨¡å¼*æ­£æ˜¯è‡´åŠ›äºè§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ä¸ªæ–¹æ¡ˆï¼Œå®ƒæŠŠæ‰€æœ‰çš„ä¿¡æ¯éƒ½å°è£…åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œè€Œé€šè¿‡æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–åŸå‹ï¼ˆä»…åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨çš„æ—¶å€™ï¼‰ï¼Œåˆä¿æŒäº†åŒæ—¶ä½¿ç”¨æ„é€ å‡½æ•°å’ŒåŸå‹çš„ä¼˜ç‚¹ã€‚

```javascript

// todo: é”™è¯¯ç¤ºä¾‹!,åŸå‹åŠ¨æ€æ¨¡å¼ä¸­å¦‚æœé‡å†™åŸå‹ï¼Œä¼šåˆ‡æ–­æ„é€ å‡½æ•°ä¸åŸå‹ç›´æ¥çš„è¿æ¥ã€‚
// ---> æ„é€ å‡½æ•°è¿æ¥çš„åŸå‹ï¼Œä¾ç„¶æ˜¯æœ€åˆè‡ªåŠ¨åˆ›å»ºçš„åŸå‹
function Person(name, age) {
    this.name = name;
    this.age = age;
    if (typeof this.sayName !== 'function') {
        Person.prototype = {
            constructor: Person,
            sayName: function () {
                console.log(this.name);
            },
            sayHi: function () {
                console.log('Hi')
            },
            friends: ['Dogs', 'Cats']
        }
    }
}

var p1 = new Person('Tom', 23);
var p2 = new Person();

console.log(Object.getPrototypeOf(p1)); // {constructor: Æ’}
p1.sayName();  // TypeError: p1.sayName is not a function
// p2.sayName();

```
> é€šè¿‡`console.log(Object.getPrototypeOf(p1)); // {constructor: Æ’}`å¯ä»¥æ˜æ˜¾çœ‹åˆ°ï¼Œæ„é€ å‡½æ•°è¿æ¥çš„åŸå‹å¯¹è±¡è¿˜æ˜¯é»˜è®¤çš„åŸå‹å¯¹è±¡ï¼Œè€Œä¸æ˜¯è‡ªå·±é‡å†™çš„åŸå‹å¯¹è±¡ã€‚

<>
> æ­£ç¡®çš„*åŠ¨æ€åŸå‹æ¨¡å¼*çš„æ‰“å¼€æ–¹å¼ï¼š

```javascript
function Person(name, age) {
    this.name = name;
    this.age = age;

// todo: æ³¨æ„è¿™é‡Œçš„åˆ¤æ–­ï¼Œåªè¦å¯¹ä»»æ„ä¸€ä¸ªå…±äº«çš„æ–¹æ³•åšè¿™ä¸ªåˆ¤æ–­å³å¯
    if (typeof this.sayName !== 'function') {
        Person.prototype.sayName = function () {
            console.log(this.name);
        };
        Person.prototype.sayHi = function () {
            console.log('Hi');
        };
        Person.prototype.friends = ['Dogs', 'Cats'];
    }
}

var p1 = new Person('Tom', 23);
var p2 = new Person();

console.log(Object.getPrototypeOf(p1)); // {constructor: Æ’}
p1.sayName();  // TypeError: p1.sayName is not a function
p2.sayName();
```

æ³¨æ„æ„é€ å‡½æ•°ä¸­çš„`if`åˆ¤æ–­çš„éƒ¨åˆ†ï¼Œè¿™é‡Œåªåœ¨`sayName()`æ–¹æ³•ä¸å­˜åœ¨æ—¶ï¼Œæ‰ä¼šæ‰§è¡Œé‡Œé¢çš„ä»£ç ã€‚æ­¤åï¼ŒåŸå‹å·²ç»å®Œæˆåˆå§‹åŒ–ã€‚ç”±äº*åŸå‹çš„åŠ¨æ€æ€§*ï¼Œå¯¹åŸå‹çš„ä¿®æ”¹ï¼Œä¼šç«‹å³åæ˜ åˆ°æ‰€æœ‰çš„å®ä¾‹ä¸Šã€‚å› æ­¤è¿™ç§æ–¹å¼æ²¡æœ‰ä»»ä½•çš„å‰¯ä½œç”¨ã€‚<span style="color: blue">å¯¹äºé‡‡ç”¨è¿™ç§æ–¹å¼åˆ›å»ºçš„å¯¹è±¡ï¼Œè¿˜å¯ä»¥ä½¿ç”¨`instanceof`æ“ä½œç¬¦ç¡®å®šå®ƒçš„ç±»å‹ã€‚(ä¸æ¸…æ¥šè¿™å¥è¯æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Œå‰é¢çš„å‡ ç§æ–¹å¼ä¸éƒ½å¯ä»¥å˜›ï¼)</span>

###### 2.6 å¯„ç”Ÿæ„é€ å‡½æ•°æ¨¡å¼

é€šå¸¸ï¼Œåœ¨å‰è¿°å‡ ç§æ¨¡å¼éƒ½ä¸é€‚ç”¨çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨å¯„ç”Ÿ(`parasitic`)æ„é€ å‡½æ•°æ¨¡å¼ã€‚è¿™ç§æ¨¡å¼çš„åŸºæœ¬æ€æƒ³æ˜¯åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°çš„ä½œç”¨ä»…ä»…æ˜¯å°è£…åˆ›å»ºå¯¹è±¡çš„ä»£ç ï¼Œç„¶åå†è¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡ï¼›ä½†ä»è¡¨é¢ä¸Šçœ‹ï¼Œè¿™ä¸ªå‡½æ•°åˆå¾ˆåƒæ˜¯å…¸å‹çš„æ„é€ å‡½æ•°ã€‚å¦‚ä¸‹ï¼š

```javascript
function Person(name,age,job){
	var o = new Object();
	o.name = name;
	o.age = age;
	o.sayName = function() {
		// console.log("this is ? "+(this instanceof Person)); // false
		console.log(this.name);
	}
	// console.log("this is -- ? "+(this instanceof Person)); // true
	return o;
}

var friend = new Person('Stone', 29 , 'software engineer');
friend.sayName();
```
> ä»è¾“å‡ºä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œåœ¨`o.sayName()`ä¸­çš„`this`æ˜¯ `Object`ç±»å‹çš„ï¼Œåœ¨ä¸‹ä¸€ä¸ª`this`å°±æ˜¯`Person`ç±»å‹çš„ã€‚

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ`Person`å‡½æ•°åˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä»¥ç›¸åº”çš„å±æ€§å’Œæ–¹æ³•åˆå§‹åŒ–è¯¥å¯¹è±¡ï¼Œç„¶åè¿”å›äº†è¿™ä¸ªå¯¹è±¡ã€‚é™¤äº†ä½¿ç”¨`new`æ“ä½œç¬¦å¹¶æŠŠä½¿ç”¨çš„åŒ…è£…å‡½æ•°å«åšæ„é€ å‡½æ•°ä¹‹å¤–ï¼Œè¿™ä¸ªæ¨¡å¼è·Ÿå·¥å‚æ¨¡å¼å…¶å®æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚**æ„é€ å‡½æ•°åœ¨ä¸è¿”å›å€¼çš„æƒ…å†µä¸‹ï¼Œé»˜è®¤è¿”å›æ–°å¯¹è±¡å®ä¾‹ã€‚*è€Œé€šè¿‡åœ¨æ„é€ å‡½æ•°çš„æœ«å°¾æ·»åŠ ä¸€ä¸ª`return`è¯­å¥ï¼Œå¯ä»¥é‡æ–°è°ƒç”¨æ„é€ å‡½æ•°æ—¶è¿”å›çš„å€¼*.**ã€‚

> *æ­¤ç§æ¨¡å¼(å¯„ç”Ÿæ„é€ å‡½æ•°æ¨¡å¼)å¾€å¾€æ˜¯ç”¨æ¥åˆ›å»ºåŒ…è£…ç±»å‹çš„å¯¹è±¡ï¼Œå’Œ`Java`ä¸­æ˜¯åŒ…è£…æ¨¡å¼å¾ˆç±»ä¼¼*ã€‚

```javascript
function SpecialArray() {

    var values = [];
    values.push.apply(values, arguments);

    values.toPipString = function () {
        // console.log("--"+this instanceof SpecialArray); // false
        // --> è¿™ä¸ª this çš„ç±»å‹æ˜¯ Array å¹¶ä¸æ˜¯ SpecialArray
        return this.join('|', values);
    };
    return values;

}

var sa = new SpecialArray('red', 'green', 'blue');
console.log(sa.toPipString());

console.log(sa instanceof SpecialArray); // false
```
> æ¯”å¦‚ä¸Šé¢çš„ä»£ç ï¼Œé€šè¿‡åŒ…è£…`Array`åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ç±»å‹`SpecialArray`ã€‚ä¸è¿‡ï¼Œé€šè¿‡ `instanceof`æ“ä½œç¬¦ï¼Œå¹¶ä¸èƒ½è¯†åˆ«è¿™ä¸ªå®šåˆ¶çš„ç±»å‹ã€‚(åº”è¯¥æ˜¯*é‡æ–°è°ƒç”¨æ„é€ å‡½æ•°æ—¶è¿”å›çš„å€¼*å¯¼è‡´çš„ã€‚)

###### 2.7 ç¨³å¦¥æ„é€ å‡½æ•°æ¨¡å¼

> ç•¥ã€‚æ„Ÿè§‰æ²¡ä»€ä¹ˆå®é™…æ„ä¹‰ã€‚

-----------------
åˆ›å»ºå¯¹è±¡çš„æ–¹æ³•æ€»ç»“ï¼š

**åˆ›å»ºå¯¹è±¡å“ªå®¶å¼ºï¼Ÿ**

- å½“ç„¶æ˜¯ï¼š  2.4ç»„åˆç»§æ‰¿ ã€‚

 <del>2.5 ä¹Ÿå¯ç”¨ï¼Œä½†æ˜¯è¦æ³¨æ„ã€‚</del>

-------------------

#### 3 ç»§æ‰¿

ç»§æ‰¿æ˜¯`OO`è¯­è¨€ä¸­çš„ä¸€ä¸ªæœ€ä¸ºæ´¥æ´¥ä¹é“çš„æ¦‚å¿µã€‚è®¸å¤š`OO`è¯­è¨€éƒ½æ”¯æŒä¸¤ç§ç»§æ‰¿æ–¹å¼ï¼šæ¥å£ç»§æ‰¿å’Œå®ç°ç»§æ‰¿ã€‚æ¥å£ç»§æ‰¿åªç»§æ‰¿æ–¹æ³•ç­¾åï¼Œè€Œå®ç°ç»§æ‰¿åˆ™ç»§æ‰¿å®é™…çš„æ–¹æ³•ã€‚å¦‚å‰æ‰€è¿°ï¼Œç”±äºå‡½æ•°æ²¡æœ‰ç­¾åï¼Œåœ¨`ECMAScript`ä¸­æ— æ³•å®ç°æ¥å£ç»§æ‰¿ã€‚`ECMAScript`åªæ”¯æŒå®ç°ç»§æ‰¿ï¼Œè€Œå…¶å®ç°ç»§æ‰¿ä¸»è¦æ˜¯ä¾é åŸå‹é“¾æ¥å®ç°çš„ã€‚

##### 3.1 åŸå‹é“¾

*`ECMAScript`ä¸­æè¿°äº†**åŸå‹é“¾**çš„æ¦‚å¿µï¼Œå¹¶å°†åŸå‹é“¾ä½œä¸ºå®ç°ç»§æ‰¿çš„ä¸»è¦æ–¹æ³•*ã€‚å…¶åŸºæœ¬æ€æƒ³æ˜¯åˆ©ç”¨åŸå‹è®©ä¸€ä¸ªå¼•ç”¨ç±»å‹ç»§æ‰¿å¦ä¸€ä¸ªå¼•ç”¨ç±»å‹çš„å±æ€§å’Œæ–¹æ³•ã€‚*æ„é€ å‡½æ•°ã€åŸå‹å’Œå®ä¾‹çš„å…³ç³»ï¼šæ¯ä¸ªæ„é€ å‡½æ•°éƒ½æœ‰ä¸€ä¸ªåŸå‹å¯¹è±¡ï¼ŒåŸå‹å¯¹è±¡éƒ½åŒ…å«ä¸€ä¸ªæŒ‡å‘æ„é€ å‡½æ•°çš„æŒ‡é’ˆã€‚è€Œå®ä¾‹éƒ½åŒ…å«ä¸€ä¸ªæŒ‡å‘åŸå‹å¯¹è±¡çš„å†…éƒ¨æŒ‡é’ˆ*ã€‚é‚£ä¹ˆï¼Œå‡å¦‚æˆ‘ä»¬è®©åŸå‹å¯¹è±¡ç­‰äºå¦ä¸€ä¸ªç±»å‹çš„å®ä¾‹ï¼Œç»“æœä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿæ˜¾ç„¶ï¼Œæ­¤æ—¶çš„åŸå‹å¯¹è±¡å°†åŒ…å«ä¸€ä¸ªæŒ‡å‘å¦ä¸€ä¸ªåŸå‹çš„æŒ‡é’ˆï¼Œç›¸åº”çš„ï¼Œå¦ä¸€ä¸ªåŸå‹ä¸­ä¹ŸåŒ…å«ç€ä¸€ä¸ªæŒ‡å‘å¦ä¸€ä¸ªæ„é€ å‡½æ•°çš„æŒ‡é’ˆã€‚å‡å¦‚å¦ä¸€ä¸ªåŸå‹åˆæ˜¯å¦ä¸€ä¸ªç±»å‹çš„å®ä¾‹ï¼Œé‚£ä¹ˆä¸Šè¿°å…³ç³»ä¾ç„¶æˆç«‹ï¼Œå¦‚æ­¤å±‚å±‚é€’è¿›ï¼Œå°±æ„æˆäº†å®ä¾‹ä¸åŸå‹çš„é“¾æ¡ã€‚è¿™å°±æ˜¯æ‰€è°“çš„åŸå‹é“¾çš„åŸºæœ¬æ¦‚å¿µã€‚

```javascript
function Apple(name) {
    this.name = name;
}

Apple.prototype.sayName = function () {
    console.log(this.name);
};

function Banana(name) {
    this.name = name;
}

Banana.prototype = new Apple('è‹¹æœ');

Banana.prototype.constructor = Banana;

function Cherry(name) {
    this.name = name;
}

Cherry.prototype = new Banana('é¦™è•‰');
Cherry.prototype.constructor = Cherry;

var ch = new Cherry('æ¨±æ¡ƒ');

console.log(ch);
```
> è¿™ä¸ªé€šè¿‡`chrome`æµè§ˆå™¨çš„æ§åˆ¶å°è¾“å‡ºå¯ä»¥å¾ˆæ˜æ˜¾çœ‹å‡ºç»§æ‰¿å…³ç³»ï¼Œå¦‚æˆ‘ä»¬é¢„æœŸã€‚`Cherry <-- Banana <-- Apple`ã€‚

```javascript
console.log((ch instanceof Cherry) 
&& (ch instanceof Banana)
&& (ch instanceof Apple)); // true
```
###### åŸå‹é“¾çš„é—®é¢˜

åŸå‹é“¾è™½ç„¶å¾ˆå¼ºå¤§ï¼Œå¯ä»¥ç”¨å®ƒæ¥å®ç°ç»§æ‰¿ï¼Œä½†æ˜¯å®ƒä¹Ÿå­˜åœ¨ä¸€äº›é—®é¢˜ã€‚å…¶ä¸­ï¼Œæœ€ä¸»è¦çš„é—®é¢˜æ¥ç€åŒ…å«å¼•ç”¨ç±»å‹å€¼çš„åŸå‹ã€‚**å‰é¢ä»‹ç»è¿‡åŒ…å«å¼•ç”¨ç±»å‹å€¼çš„åŸå‹å±æ€§ä¼šè¢«æ‰€æœ‰å®ä¾‹å…±äº«**ï¼›è€Œè¿™ä¹Ÿæ­£æ˜¯ä¸ºä»€ä¹ˆè¦å†æ„é€ å‡½æ•°ä¸­ï¼Œè€Œä¸æ˜¯åŸå‹å¯¹è±¡ä¸­å®šä¹‰å±æ€§çš„åŸå› ã€‚**åœ¨é€šè¿‡åŸå‹æ¥å®ç°ç»§æ‰¿æ—¶ï¼ŒåŸå‹å®é™…ä¸Šä¼šå˜æˆå¦ä¸€ä¸ªç±»å‹çš„å®ä¾‹ã€‚äºæ˜¯ï¼ŒåŸå…ˆçš„å®ä¾‹å±æ€§ä¹Ÿå°±é¡ºç†æˆç« åœ°å˜æˆäº†ç°åœ¨çš„ï¼ˆå­ç±»å‹å¯¹è±¡çš„ï¼‰åŸå‹å±æ€§äº†ã€‚**

é€šè¿‡åœ¨ä¸Šé¢çš„åŸå‹ç»§æ‰¿çš„ä»£ç ä¸­æ·»åŠ å‡ è¡Œä»£ç å³å¯çœ‹å‡ºé—®é¢˜ï¼š

```javascript
function Apple(name) {
    this.name = name;
    this.friends = ['cats'];
}

Apple.prototype.sayName = function () {
    console.log(this.name);
};

function Banana(name) {
    this.name = name;
}

Banana.prototype = new Apple('è‹¹æœ');

Banana.prototype.constructor = Banana;

function Cherry(name) {
    this.name = name;
}

Cherry.prototype = new Banana('é¦™è•‰');
Cherry.prototype.constructor = Cherry;

var ch = new Cherry('æ¨±æ¡ƒ');
console.log(ch);

var c2 = new Cherry('æ¡ƒå­ğŸ‘');
ch.friends.push('dogs');

console.log(c2);
console.log("ch:" + ch.friends + " #### c2:" + c2.friends);
```

> æœ€åä¸€è¡Œçš„è¾“å‡ºä¸ºï¼š`ch:cats,dogs #### c2:cats,dogs`ã€‚

> ä¹Ÿå°±æ˜¯è¯´ï¼Œæ”¹å˜äº†`Cherry`çš„æŸä¸€ä¸ªå®ä¾‹çš„å±æ€§ï¼Œä¼šå¯¼è‡´è¯¥ç±»å‹çš„å…¨éƒ¨å®ä¾‹çš„è¿™ä¸ªå±æ€§éƒ½ä¼šè¢«æ”¹å˜ã€‚è¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœï¼Œä½†æ˜¯ç¬¦åˆåŸå‹çš„é€»è¾‘ã€‚

<del>åŸå‹é“¾çš„ç¬¬äºŒä¸ªé—®é¢˜æ˜¯ï¼šåœ¨åˆ›å»ºå­ç±»å‹çš„å®ä¾‹æ—¶ï¼Œä¸èƒ½å‘è¶…ç±»å‹çš„æ„é€ å‡½æ•°ä¸­ä¼ é€’å‚æ•°ã€‚å®é™…ä¸Šï¼Œåº”è¯¥è¯´æ˜¯æ²¡æœ‰åŠæ³•åœ¨ä¸å½±å“æ‰€æœ‰å¯¹è±¡å®ä¾‹çš„æƒ…å†µä¸‹ï¼Œç»™è¶…ç±»å‹çš„æ„é€ å‡½æ•°ä¼ é€’å‚æ•°ã€‚</del>æœ‰é‰´äºæ­¤ï¼Œå†åŠ ä¸ŠåŸå‹ä¸­å±æ€§å…±äº«é—®é¢˜ï¼Œ**å®è·µä¸­å¾ˆå°‘å•ç‹¬ä½¿ç”¨åŸå‹é“¾**ã€‚

##### 3.2 å€Ÿç”¨æ„é€ å‡½æ•°

åœ¨è§£å†³åŸå‹ä¸­åŒ…å«å¼•ç”¨ç±»å‹å€¼æ‰€å¸¦æ¥é—®é¢˜çš„è¿‡ç¨‹ä¸­ï¼Œå¼€å‘äººå‘˜å¼€å§‹ä½¿ç”¨ä¸€ç§å«åš**å€Ÿç”¨æ„é€ å‡½æ•°(`constructor stealing`)**çš„æŠ€æœ¯ï¼ˆæœ‰æ—¶å€™ä¹Ÿå«åšä¼ªé€ å¯¹è±¡æˆ–ç»å…¸ç»§æ‰¿ï¼‰ã€‚è¿™ç§æŠ€æœ¯çš„åŸºæœ¬æ€æƒ³ç›¸å½“ç®€å•ï¼Œå³åœ¨å­ç±»å‹æ„é€ å‡½æ•°çš„å†…éƒ¨è°ƒç”¨è¶…ç±»å‹æ„é€ å‡½æ•°ã€‚åˆ«å¿˜äº†ï¼Œå‡½æ•°åªä¸è¿‡æ˜¯åœ¨ç‰¹å®šç¯å¢ƒä¸­æ‰§è¡Œä»£ç çš„å¯¹è±¡ï¼Œå› æ­¤é€šè¿‡ä½¿ç”¨`apply()`å’Œ`call()`æ–¹æ³•ä¹Ÿå¯ä»¥åœ¨(å°†æ¥)æ–°åˆ›å»ºçš„å¯¹è±¡ä¸Šæ‰§è¡Œæ„é€ å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```javascript
function SuperType() {
    this.colors = ['red', 'blue', 'green'];
}

function SubType() {

    SuperType.call(this); // è¿™é‡Œçš„ this æ˜¯ä»€ä¹ˆï¼Ÿ å½“ç„¶æ˜¯ SubType ç±»å‹çš„å¯¹è±¡
    // todo:æ³¨æ„ï¼Œè¿™é‡Œå¹¶æ²¡æœ‰æŠŠ SuperType()å½“æˆæ„é€ å‡½æ•°è°ƒç”¨ï¼Œè€Œæ˜¯å½“æˆæ™®é€šå‡½æ•°è°ƒç”¨äº†ã€‚
}

var instance = new SubType();
instance.colors.push('black');
console.log(instance.colors); // [ 'red', 'blue', 'green', 'black' ]

var instance2 = new SubType();
console.log(instance2.colors); // [ 'red', 'blue', 'green' ]
```

> ä¸Šè¿°ä»£ç å…¶å®ç­‰æ•ˆäºä¸‹é¢çš„å†™æ³•ï¼š

```javascript
function SuperType() {
    this.colors = ['red', 'blue', 'green'];
}

function SubType() {

    // SuperType.call(this); // è¿™é‡Œçš„ this æ˜¯ä»€ä¹ˆï¼Ÿ å½“ç„¶æ˜¯ SubType ç±»å‹çš„å¯¹è±¡
    // å¦å¤–è¿™å¥ä»£ç åˆ°åº•æ‰§è¡Œäº†ä»€ä¹ˆå‘¢ï¼Ÿ --> ç›¸å½“äºå¦‚ä¸‹çš„ä»£ç ï¼š

}
var instance = new SubType();
instance.SuperType = SuperType;
instance.SuperType();

instance.colors.push('black');
console.log(instance.colors); // [ 'red', 'blue', 'green', 'black' ]

var instance2 = new SubType();
instance2.SuperType = SuperType;
instance2.SuperType();
console.log(instance2.colors); // [ 'red', 'blue', 'green' ]

```

é€šè¿‡è¾“å‡ºå¯ä»¥çœ‹å‡ºï¼Œä»¥ä¸Šä¸¤ç§å†™æ³•çš„æ•ˆæœæ˜¯ç›¸åŒçš„ã€‚

*è€Œä¸”ï¼Œè¿™å®é™…ä¸Šå¹¶ä¸æ˜¯ä»€ä¹ˆç»§æ‰¿ã€‚ä»`console.log(instance);`åœ¨`Chrome`æ§åˆ¶å°è¾“å‡ºå¯ä»¥æ˜æ˜¾çœ‹å‡ºè¿™ä¸€ç‚¹ï¼š*

```javascript
SubType {colors: Array(4)}
colors
:
(4) ["red", "blue", "green", "black"]
__proto__
:
Object
```
> é€šè¿‡ `chrome`æŸ¥çœ‹ä¼šæ›´ç›´æ¥ï¼ˆå»ºè®®æŠŠä»¥ä¸Šä»»æ„ä¸€ç§ä»£ç æ–¹åˆ°`chrome`ä¸‹è¿è¡Œã€‚ï¼‰ã€‚

```javascript
console.log(instance instanceof SubType); // true
console.log(instance instanceof SuperType); // false
```

> ä»¥ä¸Šä¸¤å¥ä»£ç ä¹Ÿå¯ä»¥æ˜ç¡®è¿™ä¸€ç‚¹ï¼

ä¸ªäººä»¥ä¸ºï¼Œå€Ÿç”¨æ„é€ å‡½æ•°æ¨¡å¼ï¼Œä»…ä»…æ˜¯ç»™æ¯ä¸ªå®ä¾‹å¯¹è±¡åˆ›å»ºäº†ä¸å…±äº«äº†å®ä¾‹å±æ€§ã€‚å¹¶ä¸”è¿™ç§æ–¹å¼å¹¶æ²¡æœ‰å®ç°åŸå‹ç»§æ‰¿ã€‚

##### 3.3 ç»„åˆç»§æ‰¿

ç»„åˆç»§æ‰¿(`combination inheritance`)ï¼Œæœ‰æ—¶å€™ä¹Ÿå«åš*ä¼ªç»å…¸ç»§æ‰¿*ï¼ŒæŒ‡çš„æ˜¯å°†åŸå‹é“¾å’Œå€Ÿç”¨æ„é€ å‡½æ•°çš„æŠ€æœ¯ç»„åˆåˆ°ä¸€å—ï¼Œä»è€Œå‘æŒ¥äºŒè€…çº¸å‚çš„ä¸€ç§ç»§æ‰¿æ¨¡å¼ã€‚**å…¶èƒŒåçš„æ€è·¯æ˜¯ä½¿ç”¨åŸå‹é“¾å®ç°å¯¹åŸå‹å±æ€§å’Œæ–¹æ³•çš„ç»§æ‰¿ï¼Œè€Œé€šè¿‡å€Ÿç”¨æ„é€ å‡½æ•°æ¥å®ç°å¯¹å®ä¾‹å±æ€§çš„ç»§æ‰¿**ã€‚è¿™æ ·ï¼Œæ—¢é€šè¿‡åœ¨åŸå‹ä¸Šå®šä¹‰æ–¹æ³•å®ç°äº†å‡½æ•°å¤ç”¨ï¼Œåˆèƒ½ä¿è¯æ¯ä¸ªå®ä¾‹éƒ½æœ‰å®ƒè‡ªå·±çš„å±æ€§ï¼Œå¦‚ä¸‹ï¼š

```javascript
// ç¬¬ä¸€æ®µ
function SuperType(name) {
    this.name = name;
    this.colors = ['red', 'blue', 'green'];
}
// ç¬¬äºŒæ®µ
SuperType.prototype.sayName = function () {
    console.log(this.name);
};

// ç¬¬ä¸‰æ®µ
function SubType(name, age) {
    SuperType.call(this, name); // --> this.colors = ['red','blue','green']
    this.age = age;
}
// ç¬¬å››ç«¯
SubType.prototype = new SuperType();
SubType.prototype.constructor = SubType; 
// ç¬¬äº”æ®µ
SubType.prototype.sayAge = function () {
    console.log(this.age);
    // è¿™é‡Œçš„ this æ˜¯è°ï¼Ÿ
    // ç°åœ¨è¿˜çœ‹ä¸å‡ºæ¥ï¼Œè¦çœ‹è°ƒç”¨è€…ï¼Œä½†æ˜¯å¯ä»¥çŒœæµ‹ï¼Œè¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨è€…ä¸€å®šæ˜¯ä¸€ä¸ª SubType ç±»å‹çš„å¯¹è±¡ï¼Œ
    // æ‰€ä»¥ï¼Œè¿™é‡Œçš„ this å°±æ˜¯ä¸€ä¸ª ä¸€ä¸ª SubType ç±»å‹çš„å¯¹è±¡
};
// ç¬¬å…­æ®µ
var s1 = new SubType('Tom', 29);
s1.colors.push('black');
console.log(s1.colors);
s1.sayName();
s1.sayAge();

var s2 = new SubType('Ann', 33);
console.log(s2.colors);
s2.sayName();
s2.sayAge();
```
> ä¸Šè¿°ä»£ç å°±è§£å†³äº†åŸå‹å¯¹è±¡ä¸Šé¢å®šä¹‰çš„å±æ€§ä¼šè¢«å®ä¾‹å…±äº«çš„å°´å°¬ï¼ˆæ­¤å°´å°¬å‚è§ï¼š*3.1 åŸå‹é“¾*ï¼‰ã€‚

-<>- å…ˆæ¥åˆ†æä¸€ä¸‹ä¸Šé¢çš„ä»£ç ï¼Œä¸ºä»€ä¹ˆè¿™æ ·å°± *æ—¢å®ç°äº†å‡½æ•°å¤ç”¨ï¼Œåˆèƒ½ä¿è¯æ¯ä¸ªå®ä¾‹éƒ½æœ‰å®ƒè‡ªå·±çš„å±æ€§*ã€‚

> å‰é¢çš„ä¸¤æ®µä»£ç ä¸ç”¨åˆ†æï¼Œå°±æ˜¯å…¸å‹çš„*ç»„åˆä½¿ç”¨æ„é€ å‡½æ•°å’ŒåŸå‹æ¨¡å¼*çš„ä»£ç ã€‚ç„¶åæ˜¯ç¬¬ä¸‰æ®µä»£ç ï¼š

```javascript
// 3
function SubType(name, age) {
    SuperType.call(this, name);
    this.age = age;
}
```

æ³¨æ„è¿™é‡Œçš„`SuperType.call(this, name);`ï¼Œåƒä¸‡ä¸è¦è¢«`SuperType`æ˜¯æ„é€ å‡½æ•°çš„æ¦‚å¿µç»™å”¬ä½äº†ã€‚ï¼ˆ**æ¯ä¸ªæ„é€ å‡½æ•°éƒ½å¯ä»¥æ˜¯æ™®é€šå‡½æ•°ã€‚åªè¦ä¸æ˜¯é€šè¿‡`new`æ“ä½œç¬¦å»è°ƒç”¨çš„å‡½æ•°ï¼Œéƒ½æ˜¯æ™®é€šå‡½æ•°ã€‚**ï¼‰åœ¨è¿™å¥ä»£ç é‡Œï¼Œä½¿ç”¨äº†`call()`è¯­æ³•ã€‚`call(thisValue,args)`ï¼Œå› ä¸ºæ˜¯`call()`ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äº**`SubType`çš„å®ä¾‹**æœ‰ä¸€ä¸ªæ™®é€šå‡½æ•°å«åš`SuperType`ï¼Œç„¶ååœ¨æ­¤æ—¶è°ƒç”¨äº†ã€‚è€Œè¿™ä¸€è°ƒç”¨ï¼Œå°±æ˜¯ç»™è‡ªå·±æ·»åŠ äº†ä¸¤ä¸ªå±æ€§`name`å’Œ`colors`ã€‚

ç„¶ååé¢ä¸€å¥`this.age = age;`å°±ä¸ç”¨è¯´äº†ã€‚

> ç„¶åæ˜¯ç¬¬4æ®µä»£ç ï¼š

```javascript
// 4
SubType.prototype = new SuperType();
SubType.prototype.constructor = SubType; 
```

è¿™æ®µä»£ç ï¼Œåœ¨*åŸå‹é“¾*ä¸­å·²ç»è§è¯†è¿‡ï¼Œå°±æ˜¯å°†å½“å‰æ„é€ å‡½æ•°çš„åŸå‹é‡å†™ä¸ºçˆ¶ç±»å‹çš„å®ä¾‹ã€‚(å¹¶ä¸”é‡å†™è‡ªå·±æ„é€ å‡½æ•°ã€‚)é€šè¿‡ä¿®æ”¹åŸå‹ï¼Œå®ç°äº†ç»§æ‰¿ã€‚

> ç„¶åæ˜¯ç¬¬5æ®µä»£ç ï¼š

```javascript
// 5
SubType.prototype.sayAge = function () {
    console.log(this.age);
};
```

è¿™æ®µä»£ç ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯é€šè¿‡è‡ªå·±çš„åŸå‹å±æ€§ï¼Œæ·»åŠ ä¸€ä¸ªå…±äº«æ–¹æ³•ã€‚
> ç„¶åç¬¬6æ®µä»£ç æ˜¯éªŒè¯æ€§ä»£ç ï¼Œä¹Ÿä¸å¿…è§£é‡Šäº†ã€‚

**é€šè¿‡å¯¹ä¸Šè¿°ä»£ç çš„åˆ†æå¯çŸ¥ï¼šå®ç°*å‡½æ•°å¤ç”¨*çš„ä»£ç æ®µæ˜¯[ç¬¬4æ®µä»£ç ]ï¼Œ*ä¿è¯æ¯ä¸ªå®ä¾‹éƒ½æœ‰å®ƒè‡ªå·±çš„å±æ€§*çš„ä»£ç æ˜¯[ç¬¬3æ®µä»£ç ]**ã€‚

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ`SuperType`æ„é€ å‡½æ•°å®šä¹‰äº†ä¸¤ä¸ªå±æ€§ï¼š`name`å’Œ`colors`ã€‚`SubperType`çš„åŸå‹å®šä¹‰äº†ä¸€ä¸ªæ–¹æ³•`sayName()`ã€‚`SubType`æ„é€ å‡½æ•°åœ¨è°ƒç”¨`SubperType`æ„é€ å‡½æ•°æ—¶ä¼ å…¥äº†`name`å‚æ•°ã€‚(å®é™…ä¸Šï¼Œè¿™é‡Œæ˜¯æŠŠ`SuperType()`å½“æˆæ™®é€šå‡½æ•°å»ä½¿ç”¨çš„ã€‚)ç´§æ¥ç€ï¼Œåˆå®šä¹‰äº†å®ƒè‡ªå·±çš„å±æ€§`age`ã€‚ç„¶åï¼Œå°†`SuperType`çš„å®ä¾‹èµ‹å€¼ç»™`SubType`çš„åŸå‹ï¼Œç„¶ååˆå†è¯¥æ–°åŸå‹ä¸Šå®šä¹‰äº†æ–¹æ³•`sayAge()`ã€‚è¿™æ ·ä¸€æ¥å°±å¯ä»¥è®©ä¸¤ä¸ªä¸åŒçš„`SubType`å®ä¾‹æ—¢åˆ†åˆ«æ‹¥æœ‰è‡ªå·±çš„å±æ€§(åŒ…æ‹¬`colors`å±æ€§)ï¼Œåˆå¯ä»¥ä½¿ç”¨ç›¸åŒçš„æ–¹æ³•äº†ã€‚


**ç»„åˆç»§æ‰¿é¿å…äº†åŸå‹é“¾å’Œå€Ÿç”¨æ„é€ å‡½æ•°çš„ç¼ºé™·ï¼Œèåˆäº†å®ƒä»¬çš„ä¼˜ç‚¹ï¼Œæˆä¸º`Javascript`ä¸­æœ€å¸¸ç”¨çš„ç»§æ‰¿æ¨¡å¼ã€‚**è€Œä¸”`instanceof`å’Œ`isPrototypeOf()`ä¹Ÿèƒ½å¤Ÿç”¨äºè¯†åˆ«åŸºäºç»„åˆç»§æ‰¿åˆ›å»ºçš„å¯¹è±¡ã€‚

> è¯¥æ–¹å¼å¯ç”¨ï¼Œä½†æ˜¯ä¸åŠ*å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿*ã€‚

##### 3.4 åŸå‹å¼ç»§æ‰¿

```javascript
function object(o){
	function F(){}
	F.prototype = o;
	return new F();
}
```

`ECMAScript5`é€šè¿‡æ–°å¢`Object.create()`æ–¹æ³•è§„èŒƒåŒ–äº†åŸå‹å¼ç»§æ‰¿ã€‚è¿™ä¸ªåˆšå‘æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªæ˜¯ç”¨ä½œæ–°å¯¹è±¡åŸå‹çš„å¯¹è±¡å’Œ(å¯é€‰çš„)ä¸€ä¸ªä¸ºæ–°å¯¹è±¡å®šä¹‰é¢å¤–å±æ€§çš„å¯¹è±¡ã€‚åœ¨ä¼ å…¥ä¸€ä¸ªå‚æ•°çš„æƒ…å†µä¸‹ï¼Œ`Object.create()`ä¸`object()`æ–¹æ³•çš„è¡Œä¸ºç›¸åŒã€‚

> è¯¥æ–¹å¼åªåšäº†ä¸€åŠçš„å·¥ä½œã€‚

##### 3.5 å¯„ç”Ÿå¼ç»§æ‰¿

å¯„ç”Ÿå¼(`parasitic`)ç»§æ‰¿ä¸å¯„ç”Ÿæ„é€ å‡½æ•°å’Œå·¥å‚æ¨¡å¼ç±»ä¼¼ï¼Œå³åˆ›å»ºä¸€ä¸ªä»…ç”¨äºå°è£…ç»§æ‰¿è¿‡ç¨‹çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°åœ¨å†…éƒ¨ä»¥æŸç§æ–¹å¼æ¥å¢å¼ºå¯¹è±¡ï¼Œæœ€åå†åƒçœŸçš„æ˜¯å®ƒåšäº†æ‰€æœ‰å·¥ä½œä¸€æ ·è¿”å›å¯¹è±¡ã€‚å¦‚ä¸‹ï¼š

```javascript
function createAnother(original){
	var clone = object(original);
	clone.sayHi = function(){
		console.log('hi');
	}
	return clone;
}
```
> è¯¥æ–¹å¼(å•ç‹¬ä½¿ç”¨çš„)æ„ä¹‰ä¸å¤§ã€‚

##### 3.6 å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿

å‰é¢è¯´è¿‡ï¼Œç»„åˆç»§æ‰¿æ˜¯`Javascript`æœ€å¸¸ç”¨çš„ç»§æ‰¿æ¨¡å¼ï¼›ä¸è¿‡ï¼Œå®ƒä¹Ÿæœ‰ä¸è¶³ä¹‹å¤„ã€‚ç»„åˆç»§æ‰¿æœ€å¤§çš„é—®é¢˜å°±æ˜¯æ— è®ºä»€ä¹ˆæƒ…å†µä¸‹ï¼Œéƒ½ä¼šè°ƒç”¨ä¸¤æ¬¡è¶…ç±»å‹æ„é€ å‡½æ•°ï¼šä¸€æ¬¡æ˜¯åˆ›å»ºå­ç±»å‹åŸå‹çš„æ—¶å€™ï¼Œå¦ä¸€ä¸ªæ˜¯åœ¨å­ç±»å‹æ„é€ å‡½æ•°å†…éƒ¨(è¿™ä¸€æ¬¡å®é™…ä¸Šæ˜¯æŠŠè¶…ç±»å‹çš„æ„é€ å‡½æ•°å½“æˆæ™®é€šå‡½æ•°è°ƒç”¨çš„)ã€‚å­ç±»å‹æœ€ç»ˆä¼šåŒ…å«è¶…ç±»å‹å¯¹è±¡çš„å…¨éƒ¨å®ä¾‹å±æ€§ï¼Œä½†æˆ‘ä»¬ä¸å¾—ä¸åœ¨è°ƒç”¨å­ç±»å‹æ„é€ å‡½æ•°çš„æ—¶å€™é‡å†™è¿™äº›å±æ€§ã€‚å†çœ‹ä¸€çœ‹ç»„åˆç»§æ‰¿çš„ä»£ç ï¼š

```javascript
function SuperType(name){
	this.name = name;
	this.colors = ['red','green','blue'];
}
SuperType.prototype.sayName = function(){
	console.log(this.name);
}
function SubType(name,age){
	SuperType.call(this,name); // ç¬¬äºŒæ¬¡è°ƒç”¨ SuperType() [ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨]
	this.age = age;
}

SubType.prototype = new SuperType(); // ç¬¬ä¸€æ¬¡è°ƒç”¨ SuperType() [ä½œä¸ºæ„é€ å‡½æ•°è°ƒç”¨]
SubType.prototype.constructor = SubType;

SubType.prototype.sayAge = function(){
	console.log(this.age);
}

```

ä»¥ä¸Šå°±æ˜¯`SuperType()`è¢«ä¸¤æ¬¡è°ƒç”¨çš„åœ°æ–¹ã€‚åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨`SuperType()`*æ„é€ å‡½æ•°*æ—¶ï¼Œ`SubType.prototype`ä¼šå¾—åˆ°ä¸¤ä¸ªå±æ€§ï¼š`name`å’Œ`colors`ï¼›å®ƒä»¬éƒ½æ˜¯`SuperType`çš„å®ä¾‹å±æ€§ï¼Œåªä¸è¿‡ç°åœ¨ä½äº`SubType`çš„åŸå‹ä¸­ã€‚å½“è°ƒç”¨`SubType`æ„é€ å‡½æ•°æ—¶ï¼Œåˆä¼šè°ƒç”¨ä¸€æ¬¡`SuperType()`*æ™®é€š*å‡½æ•°ï¼Œè¿™ä¸€æ¬¡åˆå†`SubType`çš„æ–°å¯¹è±¡ä¸Šåˆ›å»ºäº†å®ä¾‹å±æ€§`name`å’Œ`colors`ã€‚äºæ˜¯ï¼Œè¿™ä¸¤ä¸ªå±æ€§å°±å±è”½äº†åŸå‹ä¸­çš„ä¸¤ä¸ªåŒåå±æ€§ã€‚

**æœ‰ä¸¤ç»„`name`å’Œ`colors`å±æ€§ï¼šä¸€ç»„åœ¨å®ä¾‹ä¸Šï¼Œä¸€ç»„åœ¨`SubType`åŸå‹ä¸­ã€‚è¿™å°±æ˜¯è°ƒç”¨ä¸¤æ¬¡`SuperType()`çš„ç»“æœ**ã€‚å¥½åœ¨æˆ‘ä»¬å·²ç»æ‰¾åˆ°äº†è§£å†³æ–¹æ³•--å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿ã€‚

æ‰€è°“**å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿**ï¼Œå³é€šè¿‡å€Ÿç”¨æ„é€ å‡½æ•°æ¥ç»§æ‰¿å±æ€§ï¼Œé€šè¿‡åŸå‹é“¾çš„æ··æˆå½¢å¼æ¥ç»§æ‰¿æ–¹æ³•ã€‚å…¶èƒŒåçš„åŸºæœ¬æ€è·¯æ˜¯ï¼šä¸å¿…ä¸ºäº†æŒ‡å®šå­ç±»å‹çš„åŸå‹è€Œè°ƒç”¨è¶…ç±»å‹çš„æ„é€ å‡½æ•°ã€‚æˆ‘ä»¬æ‰€éœ€è¦çš„æ— éå°±æ˜¯è¶…ç±»å‹åŸå‹çš„ä¸€ä¸ªå‰¯æœ¬è€Œå·²ã€‚æœ¬è´¨ä¸Šï¼Œå°±æ˜¯ä½¿ç”¨å¯„ç”Ÿå¼ç»§æ‰¿æ¥ç»§æ‰¿è¶…ç±»å‹çš„åŸå‹ï¼Œç„¶åå†å°†ç»“æœæŒ‡å®šç»™å­ç±»å‹çš„åŸå‹ã€‚å¦‚ä¸‹ï¼š

```javascript
// todo: javascript ç»§æ‰¿çš„æœ€ä½³å®è·µï¼
function extend(Child, Parent) {

    var F = function () {
    };

    F.prototype = Parent.prototype;

    Child.prototype = new F();

    Child.prototype.constructor = Child;

    Child.uber = Parent.prototype;

}
function SuperType(name){
	this.name = name;
	this.colors = ['red','blue','green'];
}
SuperType.prototype.sayName = function(){
	console.log();
}
function SubType(name,age){
	SuperType.call(this,name);
	this.age = age;
}

extend(SubType,SuperType);
SubType.prototype.sayAge = function(){
	console.log(this.age);
}
```

è¿™ä¸ªä¾‹å­çš„é«˜æ•ˆç‡ä½“ç°åœ¨å®ƒåªè°ƒç”¨äº†ä¸€æ¬¡`SuperType()`å‡½æ•°[æ™®é€šæ–¹å¼è°ƒç”¨]ï¼Œå¹¶ä¸”é¿å…äº†åœ¨`SubType.prototype`ä¸Šé¢åˆ›å»ºä¸å¿…è¦çš„å±æ€§ã€‚ä¸æ­¤åŒæ—¶ï¼ŒåŸå‹é“¾ä¿å­˜ä¸å˜ï¼›å› æ­¤ï¼Œè¿˜èƒ½å¤Ÿæ­£å¸¸ä½¿ç”¨`instanceof`å’Œ`isPrototyOf()`ã€‚**å¼€å‘äººå‘˜æ™®éè®¤ä¸º*å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿*æ˜¯å¼•ç”¨ç±»å‹æœ€ç†æƒ³çš„ç»§æ‰¿èŒƒå¼**ã€‚

> `YUI`çš„`YAHOO.lang.extend()`æ–¹æ³•é‡‡ç”¨äº†å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿ï¼Œä»è€Œè®©è¿™ç§æ¨¡å¼é¦–æ¬¡å‡ºç°åœ¨äº†ä¸€ä¸ªåº”ç”¨éå¸¸å¹¿æ³›çš„`Javascript`åº“ä¸­ã€‚

#### 4 å°ç»“

`ECMAScript`æ”¯æŒé¢å‘å¯¹è±¡(`OO`)ç¼–ç¨‹ï¼Œä½†ä¸ä½¿ç”¨ç±»æˆ–è€…æ¥å£ã€‚å¯¹è±¡å¯ä»¥åœ¨ä»£ç æ‰§è¡Œè¿‡ç¨‹ä¸­åˆ›å»ºå’Œå¢å¼ºï¼Œå› æ­¤å…·æœ‰åŠ¨æ€æ€§è€Œéä¸¥æ ¼å®šä¹‰çš„å®ä½“ã€‚åœ¨æ²¡æœ‰ç±»çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é‡‡ç”¨ä¸‹åˆ—æ¨¡å¼åˆ›å»ºå¯¹è±¡ã€‚

* å·¥å‚æ¨¡å¼ï¼Œä½¿ç”¨ç®€å•çš„å‡½æ•°åˆ›å»ºå¯¹è±¡ï¼Œä¸ºå¯¹è±¡æ·»åŠ å±æ€§å’Œæ–¹æ³•ï¼Œç„¶åè¿”å›å¯¹è±¡ã€‚*è¿™ä¸ªæ¨¡å¼åæ¥è¢«æ„é€ å‡½æ•°æ¨¡å¼æ‰€å–ä»£*ã€‚
* æ„é€ å‡½æ•°æ¨¡å¼ï¼Œå¯ä»¥åˆ›å»ºè‡ªå®šä¹‰å¼•ç”¨ç±»å‹ï¼Œå¯ä»¥åƒåˆ›å»ºå†…ç½®å¯¹è±¡å®ä¾‹ä¸€æ ·ä½¿ç”¨`new`æ“ä½œç¬¦ï¼Œä¸è¿‡ï¼Œæ„é€ å‡½æ•°ä¹Ÿæœ‰ç¼ºç‚¹ï¼Œå³å®ƒçš„æ¯ä¸ªæˆå‘˜éƒ½æ— æ³•å¤åŸï¼ŒåŒ…æ‹¬å‡½æ•°ã€‚ç”±äºå‡½æ•°å¯ä»¥ä¸å±€é™äºä»»ä½•å¯¹è±¡(å³ä¸å¯¹è±¡å…·æœ‰æ¾è€¦åˆçš„ç‰¹ç‚¹)ï¼Œå› æ­¤æ²¡æœ‰ç†ç”±ä¸åœ¨å¤šä¸ªå¯¹è±¡é—´å…±äº«å‡½æ•°ã€‚
* åŸå‹æ¨¡å¼ï¼Œä½¿ç”¨æ„é€ å‡½æ•°çš„`prototype`å±æ€§æ¥åˆ¶å®šé‚£äº›åº”è¯¥å…±äº«çš„å±æ€§å’Œæ–¹æ³•ã€‚**ç»„åˆä½¿ç”¨æ„é€ å‡½æ•°å’ŒåŸå‹æ¨¡å¼æ—¶ï¼Œä½¿ç”¨æ„é€ å‡½æ•°å®šä¹‰å®ä¾‹å±æ€§ï¼Œè€Œä½¿ç”¨åŸå‹å®šä¹‰å…±äº«çš„å±æ€§å’Œæ–¹æ³•ã€‚**

`Javascript`ä¸»è¦é€šè¿‡åŸå‹é“¾å®ç°ç»§æ‰¿ã€‚åŸå‹é“¾çš„æ„å»ºæ˜¯é€šè¿‡å°†ä¸€ä¸ªç±»å‹çš„å®ä¾‹èµ‹å€¼ç»™å¦ä¸€ä¸ªæ„é€ å‡½æ•°çš„åŸå‹å®ç°çš„ã€‚è¿™æ ·ï¼Œå­ç±»å‹å°±èƒ½å¤Ÿè®¿é—®è¶…ç±»å‹çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œè¿™ä¸€ç‚¹ä¸åŸºäºç±»çš„ç»§æ‰¿å¾ˆç›¸ä¼¼ã€‚åŸå‹é“¾çš„é—®é¢˜æ˜¯å¯¹è±¡å®ä¾‹å…±äº«æ‰€æœ‰ç»§æ‰¿çš„å±æ€§å’Œæ–¹æ³•ã€‚å› æ­¤ä¸å®œå•ç‹¬ä½¿ç”¨ï¼Œè§£å†³è¿™ä¸ªé—®é¢˜çš„æŠ€æœ¯æ˜¯å€Ÿç”¨æ„é€ å‡½æ•°ã€‚å³å­ç±»å‹æ„é€ å‡½æ•°çš„å†…éƒ¨è°ƒç”¨è¶…ç±»å‹æ„é€ å‡½æ•°(å®é™…ä¸Šæ˜¯å½“åˆæ™®é€šå‡½æ•°å»è°ƒç”¨)ã€‚è¿™æ ·å°±å¯ä»¥åšåˆ°æ¯ä¸ªå®ä¾‹å…·æœ‰è‡ªå·±çš„å±æ€§ï¼ŒåŒæ—¶è¿˜èƒ½ä¿è¯åªä½¿ç”¨æ„é€ å‡½æ•°æ¨¡å¼æ¥å®šä¹‰ç±»å‹ã€‚**ä½¿ç”¨æœ€å¤šçš„ç»§æ‰¿æ¨¡å¼æ˜¯ç»„åˆç»§æ‰¿ï¼Œè¿™ç§æ¨¡å¼ä½¿ç”¨åŸå‹é“¾ç»§æ‰¿å…±äº«çš„å±æ€§å’Œæ–¹æ³•ï¼Œè€Œé€šè¿‡å€Ÿç”¨æ„é€ å‡½æ•°ç»§æ‰¿å®ä¾‹å±æ€§**ã€‚

æ­¤å¤–ï¼Œè¿˜æœ‰ä¸‹åˆ—å¯ä¾›é€‰æ‹©çš„ç»§æ‰¿æ¨¡å¼ï¼š

* åŸå‹å¼ç»§æ‰¿ã€‚å¯ä»¥åœ¨ä¸å¿…é¢„å…ˆå®šä¹‰æ„é€ å‡½æ•°çš„æƒ…å†µä¸‹å®ç°ç»§æ‰¿ï¼Œå…¶æœ¬è´¨æ˜¯æ‰§è¡Œå¯¹ç»™å®šå¯¹è±¡çš„æµ…å¤åˆ¶ã€‚è€Œå¤åˆ¶å¾—åˆ°çš„å‰¯æœ¬è¿˜å¯ä»¥å¾—åˆ°è¿›ä¸€æ­¥æ”¹é€ ã€‚==> ä¸è°ƒç”¨`Object.create(original);`è¡Œä¸ºç›¸åŒã€‚
* å¯„ç”Ÿå¼ç»§æ‰¿ï¼Œä¸åŸå‹å¼ç»§æ‰¿éå¸¸ç›¸ä¼¼ï¼Œä¹Ÿæ˜¯åŸºäºæŸä¸ªå¯¹è±¡æˆ–æŸäº›ä¿¡æ¯åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åå¢å¼ºå¯¹è±¡ï¼Œæœ€åè¿”å›å¯¹è±¡ã€‚ä¸ºäº†è§£å†³ç»„åˆç»§æ‰¿æ¨¡å¼ç”±äºå¤šæ¬¡(å…¶å®æ˜¯ä¸¤æ¬¡)è°ƒç”¨è¶…ç±»å‹æ„é€ å‡½æ•°(å…¶å®ç¬¬äºŒæ¬¡æ˜¯ä½œä¸ºæ™®é€šå‡½æ•°æ¥è°ƒç”¨çš„)è€Œå¯¼è‡´çš„ä½æ•ˆç‡çš„é—®é¢˜ï¼Œå¯ä»¥å°†è¿™ä¸ªæ¨¡å¼ä¸ç»„åˆç»§æ‰¿ä¸€èµ·ä½¿ç”¨ã€‚
* **å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿ï¼Œé›†å¯„ç”Ÿå¼ç»§æ‰¿å’Œç»„åˆç»§æ‰¿çš„ä¼˜ç‚¹äºä¸€èº«ï¼Œæ˜¯å®ç°åŸºäºç±»å‹ç»§æ‰¿çš„æœ€æœ‰æ•ˆæ–¹å¼ã€‚**


